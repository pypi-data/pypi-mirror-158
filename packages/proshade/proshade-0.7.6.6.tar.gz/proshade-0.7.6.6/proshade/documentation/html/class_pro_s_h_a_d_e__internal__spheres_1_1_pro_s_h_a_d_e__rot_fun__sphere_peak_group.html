<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.6.6 (JUL 2022)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This class contains peak groups detected in the rotation function mapped spheres.  
 <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_pro_s_h_a_d_e__spheres_8hpp_source.html">ProSHADE_spheres.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8edbe0a36f9af831a2160455386863ba"><td class="memItemLeft" align="right" valign="top">proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> (proshade_signed origLat, proshade_signed testedLat)</td></tr>
<tr class="memdesc:a8edbe0a36f9af831a2160455386863ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes two lattitude or longitude positions and finds the smallest distance between them considering the border periodicity.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">More...</a><br /></td></tr>
<tr class="separator:a8edbe0a36f9af831a2160455386863ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdf51386543312d582141f8f052ea269"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#abdf51386543312d582141f8f052ea269">getAllAngleDifferences</a> (std::vector&lt; proshade_double &gt; *angDiffs, std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt; sphereVals)</td></tr>
<tr class="memdesc:abdf51386543312d582141f8f052ea269"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes all angles present in this peak group and finds the set of unique angle differeces.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#abdf51386543312d582141f8f052ea269">More...</a><br /></td></tr>
<tr class="separator:abdf51386543312d582141f8f052ea269"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae52976c645e0860dfebb0cf209ae2235"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ae52976c645e0860dfebb0cf209ae2235">getAllPossibleFolds</a> (std::vector&lt; proshade_double &gt; *angDiffs, std::vector&lt; proshade_unsign &gt; *foldsToTry)</td></tr>
<tr class="memdesc:ae52976c645e0860dfebb0cf209ae2235"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function angle differences and creates a list of folds that may be present in the group.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ae52976c645e0860dfebb0cf209ae2235">More...</a><br /></td></tr>
<tr class="separator:ae52976c645e0860dfebb0cf209ae2235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38b79345282923aa96a7b3ad7694985d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a38b79345282923aa96a7b3ad7694985d">getSpheresFormingFold</a> (proshade_unsign foldToTry, std::vector&lt; proshade_unsign &gt; *spheresFormingFold, std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt; sphereVals, proshade_double sphereAngleTolerance)</td></tr>
<tr class="memdesc:a38b79345282923aa96a7b3ad7694985d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply finds the indices of the spheres which form the requested form.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a38b79345282923aa96a7b3ad7694985d">More...</a><br /></td></tr>
<tr class="separator:a38b79345282923aa96a7b3ad7694985d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa258af3697740d56ca7aff7ce5a80470"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#aa258af3697740d56ca7aff7ce5a80470">getBestIndexForFold</a> (proshade_double *bestPosVal, proshade_double *bestLatInd, proshade_double *bestLonInd, std::vector&lt; proshade_unsign &gt; *spheresFormingFold, std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt; sphereVals)</td></tr>
<tr class="memdesc:aa258af3697740d56ca7aff7ce5a80470"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function which does simple search through all peak groups indices and saves the index with the highest peak height sum over all spheres.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#aa258af3697740d56ca7aff7ce5a80470">More...</a><br /></td></tr>
<tr class="separator:aa258af3697740d56ca7aff7ce5a80470"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44a3b756a1d72878b3721485319604d4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a44a3b756a1d72878b3721485319604d4">ProSHADE_rotFun_spherePeakGroup</a> (proshade_double lat, proshade_double lon, proshade_unsign sphPos, proshade_unsign angDim)</td></tr>
<tr class="memdesc:a44a3b756a1d72878b3721485319604d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for getting empty <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> class.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a44a3b756a1d72878b3721485319604d4">More...</a><br /></td></tr>
<tr class="separator:a44a3b756a1d72878b3721485319604d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a63c383ca601257ccc3b2d233bf9ade"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a3a63c383ca601257ccc3b2d233bf9ade">~ProSHADE_rotFun_spherePeakGroup</a> (void)</td></tr>
<tr class="memdesc:a3a63c383ca601257ccc3b2d233bf9ade"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> class.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a3a63c383ca601257ccc3b2d233bf9ade">More...</a><br /></td></tr>
<tr class="separator:a3a63c383ca601257ccc3b2d233bf9ade"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1480e2030bf06232112b56d7108aa383"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a1480e2030bf06232112b56d7108aa383">checkIfPeakBelongs</a> (proshade_double lat, proshade_double lon, proshade_unsign sphPos, proshade_double cosTol, proshade_signed verbose, proshade_signed messageShift, proshade_double allowedAngle)</td></tr>
<tr class="memdesc:a1480e2030bf06232112b56d7108aa383"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function takes a new prospective peak and tests if it belongs to this peak group or not.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a1480e2030bf06232112b56d7108aa383">More...</a><br /></td></tr>
<tr class="separator:a1480e2030bf06232112b56d7108aa383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5632fb5fe86d3be126f37936568efbcf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a5632fb5fe86d3be126f37936568efbcf">findCyclicPointGroupsGivenFold</a> (std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt; sphereVals, std::vector&lt; proshade_double * &gt; *detectedCs, bool bicubicInterp, proshade_unsign fold, proshade_signed verbose, proshade_signed messageShift)</td></tr>
<tr class="memdesc:a5632fb5fe86d3be126f37936568efbcf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function detecting cyclic point groups with a particular fold in a peak group.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a5632fb5fe86d3be126f37936568efbcf">More...</a><br /></td></tr>
<tr class="separator:a5632fb5fe86d3be126f37936568efbcf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c2bf68cb38e2908f8ec78e1bcf987c"><td class="memItemLeft" align="right" valign="top"><a id="a64c2bf68cb38e2908f8ec78e1bcf987c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a64c2bf68cb38e2908f8ec78e1bcf987c">computeCornerPositions</a> (void)</td></tr>
<tr class="memdesc:a64c2bf68cb38e2908f8ec78e1bcf987c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the group corner vectors, saving results into internal variables. <br /></td></tr>
<tr class="separator:a64c2bf68cb38e2908f8ec78e1bcf987c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5392b0e56d4778e71b8cc3210c9a4232"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a5392b0e56d4778e71b8cc3210c9a4232">getLatFromIndices</a> (void)</td></tr>
<tr class="memdesc:a5392b0e56d4778e71b8cc3210c9a4232"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor function for the private variable latFromInds.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a5392b0e56d4778e71b8cc3210c9a4232">More...</a><br /></td></tr>
<tr class="separator:a5392b0e56d4778e71b8cc3210c9a4232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab955f6dac0370b10534daf95aefb8ae3"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ab955f6dac0370b10534daf95aefb8ae3">getLatToIndices</a> (void)</td></tr>
<tr class="memdesc:ab955f6dac0370b10534daf95aefb8ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor function for the private variable latToInds.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ab955f6dac0370b10534daf95aefb8ae3">More...</a><br /></td></tr>
<tr class="separator:ab955f6dac0370b10534daf95aefb8ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada8d87a2e27b4912e21eadf3df7dd17a"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ada8d87a2e27b4912e21eadf3df7dd17a">getLonFromIndices</a> (void)</td></tr>
<tr class="memdesc:ada8d87a2e27b4912e21eadf3df7dd17a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor function for the private variable lonFromInds.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#ada8d87a2e27b4912e21eadf3df7dd17a">More...</a><br /></td></tr>
<tr class="separator:ada8d87a2e27b4912e21eadf3df7dd17a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6f1ae0d2ef19b80c52dee0936aec54be"><td class="memItemLeft" align="right" valign="top">proshade_double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a6f1ae0d2ef19b80c52dee0936aec54be">getLonToIndices</a> (void)</td></tr>
<tr class="memdesc:a6f1ae0d2ef19b80c52dee0936aec54be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor function for the private variable lonToInds.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a6f1ae0d2ef19b80c52dee0936aec54be">More...</a><br /></td></tr>
<tr class="separator:a6f1ae0d2ef19b80c52dee0936aec54be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b8f8adfd3449c187a6c4804463a68f1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; proshade_unsign &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a3b8f8adfd3449c187a6c4804463a68f1">getSpherePositions</a> (void)</td></tr>
<tr class="memdesc:a3b8f8adfd3449c187a6c4804463a68f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Accessor function for the private variable spherePositions.  <a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a3b8f8adfd3449c187a6c4804463a68f1">More...</a><br /></td></tr>
<tr class="separator:a3b8f8adfd3449c187a6c4804463a68f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a618aa1c99f72abd8cc90b69caf5e7393"><td class="memItemLeft" align="right" valign="top"><a id="a618aa1c99f72abd8cc90b69caf5e7393"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>latSampling</b></td></tr>
<tr class="separator:a618aa1c99f72abd8cc90b69caf5e7393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec24caf15b74feb483e9a2320d98d1f4"><td class="memItemLeft" align="right" valign="top"><a id="aec24caf15b74feb483e9a2320d98d1f4"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>lonSampling</b></td></tr>
<tr class="separator:aec24caf15b74feb483e9a2320d98d1f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bfa2026d0b33272d7b25b5039684245"><td class="memItemLeft" align="right" valign="top"><a id="a3bfa2026d0b33272d7b25b5039684245"></a>
proshade_unsign&#160;</td><td class="memItemRight" valign="bottom"><b>dimension</b></td></tr>
<tr class="separator:a3bfa2026d0b33272d7b25b5039684245"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc7f4252591b2388a86d7283d3ff078b"><td class="memItemLeft" align="right" valign="top"><a id="acc7f4252591b2388a86d7283d3ff078b"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>latFrom</b></td></tr>
<tr class="separator:acc7f4252591b2388a86d7283d3ff078b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a605cb5f370a6c61b4ce82b4fedec964a"><td class="memItemLeft" align="right" valign="top"><a id="a605cb5f370a6c61b4ce82b4fedec964a"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>latTo</b></td></tr>
<tr class="separator:a605cb5f370a6c61b4ce82b4fedec964a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af08e1bdb2854338e2e0173146bb1f6c8"><td class="memItemLeft" align="right" valign="top"><a id="af08e1bdb2854338e2e0173146bb1f6c8"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>lonFrom</b></td></tr>
<tr class="separator:af08e1bdb2854338e2e0173146bb1f6c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15d423d91d7fb896ff82e11dd93c0900"><td class="memItemLeft" align="right" valign="top"><a id="a15d423d91d7fb896ff82e11dd93c0900"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>lonTo</b></td></tr>
<tr class="separator:a15d423d91d7fb896ff82e11dd93c0900"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeddb2ce71f98dbf9f5a207de7d3dbe4c"><td class="memItemLeft" align="right" valign="top"><a id="aeddb2ce71f98dbf9f5a207de7d3dbe4c"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>latFromInds</b></td></tr>
<tr class="separator:aeddb2ce71f98dbf9f5a207de7d3dbe4c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59ee34fe4877585cbd7749ebd2c0ff78"><td class="memItemLeft" align="right" valign="top"><a id="a59ee34fe4877585cbd7749ebd2c0ff78"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>latToInds</b></td></tr>
<tr class="separator:a59ee34fe4877585cbd7749ebd2c0ff78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3103e7d317a360e35b5197e5c605141"><td class="memItemLeft" align="right" valign="top"><a id="aa3103e7d317a360e35b5197e5c605141"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>lonFromInds</b></td></tr>
<tr class="separator:aa3103e7d317a360e35b5197e5c605141"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac09494086e1ac66265c3949f96ebeec"><td class="memItemLeft" align="right" valign="top"><a id="aac09494086e1ac66265c3949f96ebeec"></a>
proshade_double&#160;</td><td class="memItemRight" valign="bottom"><b>lonToInds</b></td></tr>
<tr class="separator:aac09494086e1ac66265c3949f96ebeec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d5433020aea4d03cdb443fc7498031b"><td class="memItemLeft" align="right" valign="top"><a id="a1d5433020aea4d03cdb443fc7498031b"></a>
std::vector&lt; proshade_unsign &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>spherePositions</b></td></tr>
<tr class="separator:a1d5433020aea4d03cdb443fc7498031b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf5ccdceba5aa10d2219bbde538ddcfd"><td class="memItemLeft" align="right" valign="top"><a id="acf5ccdceba5aa10d2219bbde538ddcfd"></a>
proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><b>latMinLonMinXYZ</b></td></tr>
<tr class="separator:acf5ccdceba5aa10d2219bbde538ddcfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab20b1bef85e076f8309214585fefb41c"><td class="memItemLeft" align="right" valign="top"><a id="ab20b1bef85e076f8309214585fefb41c"></a>
proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><b>latMaxLonMinXYZ</b></td></tr>
<tr class="separator:ab20b1bef85e076f8309214585fefb41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab19f67a0c45b407acb835a6dc1b524e3"><td class="memItemLeft" align="right" valign="top"><a id="ab19f67a0c45b407acb835a6dc1b524e3"></a>
proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><b>latMinLonMaxXYZ</b></td></tr>
<tr class="separator:ab19f67a0c45b407acb835a6dc1b524e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c171916999c46c3e8e6e82ab0917f15"><td class="memItemLeft" align="right" valign="top"><a id="a4c171916999c46c3e8e6e82ab0917f15"></a>
proshade_double *&#160;</td><td class="memItemRight" valign="bottom"><b>latMaxLonMaxXYZ</b></td></tr>
<tr class="separator:a4c171916999c46c3e8e6e82ab0917f15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class contains peak groups detected in the rotation function mapped spheres. </p>
<p>This class codes the object that contains all the information about a single group of peaks found in the set of <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html" title="This class contains all inputed data for the rotation function angle-axis converted spheres.">ProSHADE_rotFun_sphere</a> objects with mapped rotation function values. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8hpp_source.html#l00128">128</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8hpp_source.html">ProSHADE_spheres.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a44a3b756a1d72878b3721485319604d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44a3b756a1d72878b3721485319604d4">&#9670;&nbsp;</a></span>ProSHADE_rotFun_spherePeakGroup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::ProSHADE_rotFun_spherePeakGroup </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>sphPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>angDim</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for getting empty <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> class. </p>
<p>This function simply creates an object of the <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> class and fills in the initial data.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>The lattitude value of the first peak of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>The longitude value of the first peak of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphPos</td><td>The sphere number of the peak. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">angDim</td><td>The dimensionality of the sphere grid that we are processing. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Data object with all values set and ready to add new data or search for point groups in the supplied peaks. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01070">1070</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;{</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="comment">//================================================ Compute the run-specific values</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    this-&gt;dimension                                   = angDim;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    this-&gt;lonSampling                                 = ( M_PI       ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;dimension );</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    this-&gt;latSampling                                 = ( M_PI * 2.0 ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;dimension );</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;    <span class="comment">//================================================ The constructor is called when firstt peak of the group is found. Save the values of this initial peak.</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    this-&gt;latFrom                                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( lat ) * this-&gt;latSampling;</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    this-&gt;latTo                                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( lat ) * this-&gt;latSampling;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    this-&gt;lonFrom                                     = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( lon ) * this-&gt;lonSampling;</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;    this-&gt;lonTo                                       = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( lon ) * this-&gt;lonSampling;</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    this-&gt;latFromInds                                 = lat;</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    this-&gt;latToInds                                   = lat;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    this-&gt;lonFromInds                                 = lon;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    this-&gt;lonToInds                                   = lon;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>         ( &amp;this-&gt;spherePositions, sphPos );</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">//================================================ Allocate memory for similarity positions</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    this-&gt;latMinLonMinXYZ                             = <span class="keyword">new</span> proshade_double[3];</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    this-&gt;latMaxLonMinXYZ                             = <span class="keyword">new</span> proshade_double[3];</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    this-&gt;latMinLonMaxXYZ                             = <span class="keyword">new</span> proshade_double[3];</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    this-&gt;latMaxLonMaxXYZ                             = <span class="keyword">new</span> proshade_double[3];</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;latMinLonMinXYZ, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;latMaxLonMinXYZ, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;latMinLonMaxXYZ, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a>     ( this-&gt;latMaxLonMaxXYZ, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    <span class="comment">//================================================ Compute corner vectors</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a64c2bf68cb38e2908f8ec78e1bcf987c">computeCornerPositions</a>                      ( );</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    </div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    </div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a63c383ca601257ccc3b2d233bf9ade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a63c383ca601257ccc3b2d233bf9ade">&#9670;&nbsp;</a></span>~ProSHADE_rotFun_spherePeakGroup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::~ProSHADE_rotFun_spherePeakGroup </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destructor for the <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> class. </p>
<p>This function releases all memory allocated by the <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html" title="This class contains peak groups detected in the rotation function mapped spheres.">ProSHADE_rotFun_spherePeakGroup</a> object. </p>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01109">1109</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;{</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;    <span class="comment">//================================================ Release the XYZ arrays</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    <span class="keyword">delete</span>[] this-&gt;latMinLonMinXYZ;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    <span class="keyword">delete</span>[] this-&gt;latMaxLonMinXYZ;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="keyword">delete</span>[] this-&gt;latMinLonMaxXYZ;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keyword">delete</span>[] this-&gt;latMaxLonMaxXYZ;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8edbe0a36f9af831a2160455386863ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8edbe0a36f9af831a2160455386863ba">&#9670;&nbsp;</a></span>angularDistanceWithBorders()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_signed ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::angularDistanceWithBorders </td>
          <td>(</td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>newAngul</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>currentAngul</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes two lattitude or longitude positions and finds the smallest distance between them considering the border periodicity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">newAngul</td><td>The first lattitude or longitude value. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">currentAngul</td><td>The second lattitude or longitude value. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ret</td><td>The smallest distance between the first and the second lattitude or longitude values. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01150">1150</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;{</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    proshade_signed smallerAngul                      = newAngul - <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;dimension );</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    proshade_signed largerAngul                       = newAngul + <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;dimension );</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    </div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="comment">//================================================ Find the smallest distance</span></div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    proshade_signed ret                               = std::min ( std::abs ( currentAngul - newAngul ), std::min ( std::abs ( currentAngul - smallerAngul ), std::abs ( currentAngul - largerAngul ) ) );</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    </div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;    <span class="keywordflow">return</span>                                            ( ret );</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1480e2030bf06232112b56d7108aa383"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1480e2030bf06232112b56d7108aa383">&#9670;&nbsp;</a></span>checkIfPeakBelongs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::checkIfPeakBelongs </td>
          <td>(</td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>sphPos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>cosTol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>messageShift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>allowedAngle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes a new prospective peak and tests if it belongs to this peak group or not. </p>
<p>This function takes a new peak position in terms of lattitude and longitude and proceeds to convert these to XYZ position. It then checks this XYZ position against this group's "corners" (i.e. the group's lattitude and longitude minimum and maximum borders). If the tested position belongs to the group (i.e. it has small cosine distance to one of the corners), then it is added and the group corners are updated. Otherwise, false is returned and nothing changes in the group.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>The lattitude value of the first peak of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lon</td><td>The longitude value of the first peak of the group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphPos</td><td>The sphere number of the peak. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cosTol</td><td>The tolerance for cosine distance similarity to consider the two vectors similar. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>How verbose should the run be? Use -1 if you do not want any standard output output. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageShift</td><td>Are we in a subprocess, so that the log should be shifted for this function call? If so, by how much? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allowedAngle</td><td>The maximum allowed angle in radians before point stops belonging only because the group would grow too much. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">res</td><td>Boolean value signifying if the peak was added. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01180">1180</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;{</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordtype">bool</span> peakAdded                                    = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    std::stringstream hlpSS2;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    </div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <span class="comment">//================================================ Compute peaks XYZ and its cosine distance to group corners</span></div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    proshade_double xPos                              = 1.0 * std::sin ( lon * this-&gt;lonSampling ) * std::cos ( lat * this-&gt;latSampling );</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    proshade_double yPos                              = 1.0 * std::sin ( lon * this-&gt;lonSampling ) * std::sin ( lat * this-&gt;latSampling );</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    proshade_double zPos                              = 1.0 * std::cos ( lon * this-&gt;lonSampling );</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    hlpSS2 &lt;&lt; <span class="stringliteral">&quot;Peak &quot;</span> &lt;&lt; xPos &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; yPos &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; zPos &lt;&lt; <span class="stringliteral">&quot; is close enough to group with corner &quot;</span>;</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    </div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a79e789452e327bb07a53c5358f4d3eb0">ProSHADE_internal_maths::vectorOrientationSimilaritySameDirection</a> ( xPos, yPos, zPos, this-&gt;latMinLonMinXYZ[0], this-&gt;latMinLonMinXYZ[1], this-&gt;latMinLonMinXYZ[2], cosTol ) ) { peakAdded = <span class="keyword">true</span>; hlpSS2 &lt;&lt; this-&gt;latMinLonMinXYZ[0] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMinLonMinXYZ[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMinLonMinXYZ[2]; }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a79e789452e327bb07a53c5358f4d3eb0">ProSHADE_internal_maths::vectorOrientationSimilaritySameDirection</a> ( xPos, yPos, zPos, this-&gt;latMaxLonMinXYZ[0], this-&gt;latMaxLonMinXYZ[1], this-&gt;latMaxLonMinXYZ[2], cosTol ) &amp;&amp; !peakAdded ) { peakAdded = <span class="keyword">true</span>; hlpSS2 &lt;&lt; this-&gt;latMaxLonMinXYZ[0] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMaxLonMinXYZ[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMaxLonMinXYZ[2]; }</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a79e789452e327bb07a53c5358f4d3eb0">ProSHADE_internal_maths::vectorOrientationSimilaritySameDirection</a> ( xPos, yPos, zPos, this-&gt;latMinLonMaxXYZ[0], this-&gt;latMinLonMaxXYZ[1], this-&gt;latMinLonMaxXYZ[2], cosTol ) &amp;&amp; !peakAdded ) { peakAdded = <span class="keyword">true</span>; hlpSS2 &lt;&lt; this-&gt;latMinLonMaxXYZ[0] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMinLonMaxXYZ[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMinLonMaxXYZ[2];  }</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a79e789452e327bb07a53c5358f4d3eb0">ProSHADE_internal_maths::vectorOrientationSimilaritySameDirection</a> ( xPos, yPos, zPos, this-&gt;latMaxLonMaxXYZ[0], this-&gt;latMaxLonMaxXYZ[1], this-&gt;latMaxLonMaxXYZ[2], cosTol ) &amp;&amp; !peakAdded ) { peakAdded = <span class="keyword">true</span>; hlpSS2 &lt;&lt; this-&gt;latMaxLonMaxXYZ[0] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMaxLonMaxXYZ[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; this-&gt;latMaxLonMaxXYZ[2];  }</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    </div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="comment">//================================================ If group grows over allowedAngle radians, do not add to it</span></div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span> ( peakAdded )</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        proshade_double lenPos                        = std::sqrt ( std::pow ( xPos, 2.0 ) + std::pow ( yPos, 2.0 ) + std::pow( zPos, 2.0 ) );</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        proshade_double minMinPos                     = std::sqrt ( std::pow ( this-&gt;latMinLonMinXYZ[0], 2.0 ) + std::pow ( this-&gt;latMinLonMinXYZ[1], 2.0 ) + std::pow( this-&gt;latMinLonMinXYZ[2], 2.0 ) );</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        proshade_double minMaxPos                     = std::sqrt ( std::pow ( this-&gt;latMinLonMaxXYZ[0], 2.0 ) + std::pow ( this-&gt;latMinLonMaxXYZ[1], 2.0 ) + std::pow( this-&gt;latMinLonMaxXYZ[2], 2.0 ) );</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        proshade_double maxMinPos                     = std::sqrt ( std::pow ( this-&gt;latMaxLonMinXYZ[0], 2.0 ) + std::pow ( this-&gt;latMaxLonMinXYZ[1], 2.0 ) + std::pow( this-&gt;latMaxLonMinXYZ[2], 2.0 ) );</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        proshade_double maxMaxPos                     = std::sqrt ( std::pow ( this-&gt;latMaxLonMaxXYZ[0], 2.0 ) + std::pow ( this-&gt;latMaxLonMaxXYZ[1], 2.0 ) + std::pow( this-&gt;latMaxLonMaxXYZ[2], 2.0 ) );</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="keywordflow">if</span> ( ( std::acos ( ( xPos * this-&gt;latMinLonMinXYZ[0] + yPos * this-&gt;latMinLonMinXYZ[1] + zPos * this-&gt;latMinLonMinXYZ[2] ) / ( lenPos * minMinPos ) ) &gt; allowedAngle ) ||</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;             ( std::acos ( ( xPos * this-&gt;latMinLonMaxXYZ[0] + yPos * this-&gt;latMinLonMaxXYZ[1] + zPos * this-&gt;latMinLonMaxXYZ[2] ) / ( lenPos * minMaxPos ) ) &gt; allowedAngle ) ||</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;             ( std::acos ( ( xPos * this-&gt;latMaxLonMinXYZ[0] + yPos * this-&gt;latMaxLonMinXYZ[1] + zPos * this-&gt;latMaxLonMinXYZ[2] ) / ( lenPos * maxMinPos ) ) &gt; allowedAngle ) ||</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;             ( std::acos ( ( xPos * this-&gt;latMaxLonMaxXYZ[0] + yPos * this-&gt;latMaxLonMaxXYZ[1] + zPos * this-&gt;latMaxLonMaxXYZ[2] ) / ( lenPos * maxMaxPos ) ) &gt; allowedAngle ) )</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;            peakAdded                                 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="comment">//================================================ If peak within corners, add it</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keywordflow">if</span> ( peakAdded )</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    {</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="comment">//============================================ Report progress</span></div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;Peak group dimensions changed from LAT &quot;</span> &lt;&lt; this-&gt;latFromInds &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; this-&gt;latToInds &lt;&lt; <span class="stringliteral">&quot; and LON &quot;</span> &lt;&lt; this-&gt;lonFromInds &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; this-&gt;lonToInds &lt;&lt; <span class="stringliteral">&quot; to &quot;</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 6, hlpSS2.str(), messageShift );</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="comment">//============================================ Initialise local variables</span></div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        proshade_signed largerCorner, smallerCorner;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="keywordtype">bool</span> latCornersDone                           = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="keywordtype">bool</span> lonCornersDone                           = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        </div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        <span class="comment">//============================================ Check if lattitude boundaries need to be modified</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        <span class="keywordflow">if</span> ( ( this-&gt;latFromInds &lt;= this-&gt;latToInds ) &amp;&amp; !( ( lat &gt;= this-&gt;latFromInds ) &amp;&amp; ( lat &lt;= this-&gt;latToInds ) ) )</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;            <span class="comment">//======================================== Lattitude is outside of group boundaries</span></div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;            smallerCorner                             = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lat ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;latFromInds ) );</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            largerCorner                              = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lat ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;latToInds   ) );</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            </div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &lt; largerCorner )</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;            {</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;                this-&gt;latFromInds                     = lat;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                latCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;            }</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &gt; largerCorner )</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;            {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;                this-&gt;latToInds                       = lat;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;                latCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;            }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner == largerCorner )</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;            {</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;                <span class="keywordflow">if</span>      ( lat &lt; this-&gt;latFromInds )   { this-&gt;latFromInds = lat; latCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( lat &gt; this-&gt;latToInds   )   { this-&gt;latToInds   = lat; latCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            }</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        </div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordflow">if</span> ( ( this-&gt;latFromInds &gt;  this-&gt;latToInds ) &amp;&amp; !( ( lat &gt;= this-&gt;latFromInds ) || ( lat &lt;= this-&gt;latToInds ) ) )</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        {</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            <span class="comment">//======================================== Lattitude is outside of group boundaries</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;            smallerCorner                             = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lat ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;latFromInds ) );</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;            largerCorner                              = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lat ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;latToInds   ) );</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;            </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &lt; largerCorner )</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            {</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                this-&gt;latFromInds                     = lat;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                latCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;            }</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &gt; largerCorner )</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;            {</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                this-&gt;latToInds                       = lat;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                latCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;            }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner == largerCorner )</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;            {</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                <span class="keywordflow">if</span>      ( lat &lt; this-&gt;latFromInds )   { this-&gt;latFromInds = lat; latCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( lat &gt; this-&gt;latToInds   )   { this-&gt;latToInds   = lat; latCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;            }</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        }</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        </div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="comment">//============================================ Check if longitude boundaries need to be modified</span></div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <span class="keywordflow">if</span> ( ( this-&gt;lonFromInds &lt;= this-&gt;lonToInds ) &amp;&amp; !( ( lon &gt;= this-&gt;lonFromInds ) &amp;&amp; ( lon &lt;= this-&gt;lonToInds ) ) )</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        {</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;            <span class="comment">//======================================== Lattitude is outside of group boundaries</span></div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;            smallerCorner                             = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lon ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;lonFromInds ) );</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;            largerCorner                              = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lon ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;lonToInds   ) );</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;            </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &lt; largerCorner )</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;            {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                this-&gt;lonFromInds                     = lon;</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                lonCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            }</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &gt; largerCorner )</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;            {</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                this-&gt;lonToInds                       = lon;</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                lonCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;            }</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner == largerCorner )</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            {</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;                <span class="keywordflow">if</span>      ( lon &lt; this-&gt;lonFromInds )   { this-&gt;lonFromInds = lon; lonCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( lon &gt; this-&gt;lonToInds   )   { this-&gt;lonToInds   = lon; lonCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;            }</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordflow">if</span> ( ( this-&gt;lonFromInds &gt;  this-&gt;lonToInds ) &amp;&amp; !( ( lon &gt;= this-&gt;lonFromInds ) || ( lon &lt;= this-&gt;lonToInds ) ) )</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        {</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            <span class="comment">//======================================== Lattitude is outside of group boundaries</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;            smallerCorner                             = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lon ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;lonFromInds ) );</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            largerCorner                              = <a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">angularDistanceWithBorders</a> ( <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( lon ), <span class="keyword">static_cast&lt;</span> proshade_signed <span class="keyword">&gt;</span> ( this-&gt;lonToInds   ) );</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            </div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &lt; largerCorner )</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;                this-&gt;lonFromInds                     = lon;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;                lonCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;            }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner &gt; largerCorner )</div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;            {</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;                this-&gt;lonToInds                       = lon;</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                lonCornersDone                        = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            }</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            <span class="keywordflow">if</span> ( smallerCorner == largerCorner )</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                <span class="keywordflow">if</span>      ( lon &lt; this-&gt;lonFromInds )   { this-&gt;lonFromInds = lon; lonCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( lon &gt; this-&gt;lonToInds   )   { this-&gt;lonToInds   = lon; lonCornersDone = <span class="keyword">true</span>; }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;            }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;        }</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;        </div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;        <span class="comment">//============================================ Modify corner positions</span></div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        <span class="keywordflow">if</span> ( latCornersDone )</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;        {</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;            this-&gt;latFrom                             = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;latFromInds ) * this-&gt;latSampling;</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;            this-&gt;latTo                               = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;latToInds   ) * this-&gt;latSampling;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;        </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;        <span class="keywordflow">if</span> ( lonCornersDone )</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;            this-&gt;lonFrom                             = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;lonFromInds ) * this-&gt;lonSampling;</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            this-&gt;lonTo                               = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;lonToInds   ) * this-&gt;lonSampling;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;        </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        <span class="comment">//============================================ Compute corner vectors</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;        this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a64c2bf68cb38e2908f8ec78e1bcf987c">computeCornerPositions</a>                  ( );</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;LAT &quot;</span> &lt;&lt; this-&gt;latFromInds &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; this-&gt;latToInds &lt;&lt; <span class="stringliteral">&quot; and LON &quot;</span> &lt;&lt; this-&gt;lonFromInds &lt;&lt; <span class="stringliteral">&quot; - &quot;</span> &lt;&lt; this-&gt;lonToInds &lt;&lt; <span class="stringliteral">&quot; ( peak position LAT &quot;</span> &lt;&lt; lat &lt;&lt; <span class="stringliteral">&quot; LON &quot;</span> &lt;&lt; lon &lt;&lt; <span class="stringliteral">&quot; )&quot;</span>;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a>  ( verbose, 7, hlpSS.str(), messageShift );</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;        </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="comment">//============================================ If new sphere, add it to the list</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;        <span class="keywordtype">bool</span> isSphereNew                              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign iter = 0; iter &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePositions.size() ); iter++ ) { <span class="keywordflow">if</span> ( this-&gt;spherePositions.at(iter) == sphPos ) { isSphereNew = <span class="keyword">false</span>; } }</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;        <span class="keywordflow">if</span> ( isSphereNew ) { <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( &amp;this-&gt;spherePositions, sphPos ); }</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    <span class="keywordflow">return</span>                                            ( peakAdded );</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5632fb5fe86d3be126f37936568efbcf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5632fb5fe86d3be126f37936568efbcf">&#9670;&nbsp;</a></span>findCyclicPointGroupsGivenFold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::findCyclicPointGroupsGivenFold </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt;&#160;</td>
          <td class="paramname"><em>sphereVals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double * &gt; *&#160;</td>
          <td class="paramname"><em>detectedCs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>bicubicInterp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>fold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>verbose</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_signed&#160;</td>
          <td class="paramname"><em>messageShift</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function detecting cyclic point groups with a particular fold in a peak group. </p>
<p>This function is a simplification of the findCyclicPointGroups function for the cases where the required fold is known. It simply assumes that all the supplied mapped spheres are to be used to find the fold, i.e. that fold-1 is equal to the length of sphereVals. With this assumption, the function can go directly for finding the peak index with highest peak height sum.</p>
<p>At this point, this function can also optionally do bi-cubic interpolation around this index with highest peak sum to try to improve the symmetry axis by searching between the lattitude and longitude indices. Finally, this function will create the ProSHADE formatted array of symmetry group information and save it into the supplied vector, terminating thereafter.</p>
<dl class="section warning"><dt>Warning</dt><dd>This function assumes that the supplied sphereVals argument contains only the spheres relating to the required fold and no other spheres - this assumption does not hold if the convertRotationFunction() function was called - consider yourself warned.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereVals</td><td>A vector of spheres with mapped rotation function values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">detectedCs</td><td>A vector of double pointers pointer to which any detected axis will be added in the ProSHADE format - [0] = fold, [1] = x-axis, [2] = y-axis, [3] = z-axis, [4] = angle, [5] = average peak height. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bicubicInterp</td><td>Should the bicubic interpolation between the peak indices be done? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fold</td><td>The fold for which we are searching for cyclic point groups. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">verbose</td><td>The verbosity of the run. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageShift</td><td>Are we in a subprocess, so that the log should be shifted for this function call? If so, by how much? </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01427">1427</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;{</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    proshade_double bestPosVal, bestLatInd, bestLonInd;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    std::vector&lt; proshade_unsign &gt; spheresFormingFold;</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="comment">//================================================ Set all supplied spheres to be required to form the fold</span></div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shIt = 0; shIt &lt; static_cast&lt;proshade_unsign&gt; ( sphereVals.size() ); shIt++ )</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    {</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>     ( &amp;spheresFormingFold, shIt );</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    <span class="comment">//================================================ Find the index with the highest peak height sum</span></div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    this-&gt;<a class="code" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#aa258af3697740d56ca7aff7ce5a80470">getBestIndexForFold</a>                         ( &amp;bestPosVal, &amp;bestLatInd, &amp;bestLonInd, &amp;spheresFormingFold, sphereVals );</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="comment">//================================================ Optimise by bicubic interpolation if required</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;    <span class="keywordflow">if</span> ( bicubicInterp )</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    {</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a51486f6276c28c1b503f19c36007b9e2">ProSHADE_internal_maths::optimiseAxisBiCubicInterpolation</a> ( &amp;bestLatInd, &amp;bestLonInd, &amp;bestPosVal, &amp;spheresFormingFold, &amp;sphereVals );</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;    </div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;    <span class="comment">//================================================ Create ProSHADE symmetry axis array and save it</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    proshade_double* detectedSymmetry                 = <span class="keyword">new</span> proshade_double[7];</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a> ( detectedSymmetry, __FILE__, __LINE__, __func__ );</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    </div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    detectedSymmetry[0]                               = <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( fold );</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;    detectedSymmetry[1]                               = 1.0 * std::sin ( bestLonInd * this-&gt;lonSampling ) * std::cos ( bestLatInd * this-&gt;latSampling );</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    detectedSymmetry[2]                               = 1.0 * std::sin ( bestLonInd * this-&gt;lonSampling ) * std::sin ( bestLatInd * this-&gt;latSampling );</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    detectedSymmetry[3]                               = 1.0 * std::cos ( bestLonInd * this-&gt;lonSampling );</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    detectedSymmetry[4]                               = ( 2.0 * M_PI ) / detectedSymmetry[0];</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    detectedSymmetry[5]                               = std::min ( ( bestPosVal - 1.0 ) / ( detectedSymmetry[0] - 1 ), 1.0 );</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    detectedSymmetry[6]                               = -std::numeric_limits &lt; proshade_double &gt;::infinity();</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    </div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="comment">//================================================ Make sure max is positive</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( std::max ( std::abs ( detectedSymmetry[1] ), std::max ( std::abs ( detectedSymmetry[2] ), std::abs ( detectedSymmetry[3] ) ) ) );</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs1 ( std::abs ( detectedSymmetry[1] ) );</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs2 ( std::abs ( detectedSymmetry[2] ) );</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; rhs3 ( std::abs ( detectedSymmetry[3] ) );</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    <span class="keywordflow">if</span> ( ( lhs1.AlmostEquals ( rhs1 ) &amp;&amp; ( detectedSymmetry[1] &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;         ( lhs1.AlmostEquals ( rhs2 ) &amp;&amp; ( detectedSymmetry[2] &lt; 0.0 ) ) ||</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;         ( lhs1.AlmostEquals ( rhs3 ) &amp;&amp; ( detectedSymmetry[3] &lt; 0.0 ) ) )</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    {</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        detectedSymmetry[1]                          *= -1.0;</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        detectedSymmetry[2]                          *= -1.0;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        detectedSymmetry[3]                          *= -1.0;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        detectedSymmetry[4]                          *= -1.0;</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    }</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    </div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;    <span class="comment">//================================================ Check for decimal underflows. They are not an issue as rounding to zero is fine, but having negative sign to zero will switch the signs and cause problems.</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; llhs1 ( detectedSymmetry[1] ), llhs2 ( detectedSymmetry[2] ), llhs3 ( detectedSymmetry[3] ), rrhs1 ( 0.0 );</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    <span class="keywordflow">if</span> ( llhs1.AlmostEquals ( rrhs1 ) ) { detectedSymmetry[1] = 0.0; }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;    <span class="keywordflow">if</span> ( llhs2.AlmostEquals ( rrhs1 ) ) { detectedSymmetry[2] = 0.0; }</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="keywordflow">if</span> ( llhs3.AlmostEquals ( rrhs1 ) ) { detectedSymmetry[3] = 0.0; }</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <span class="comment">//================================================ Save detected point group</span></div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a>         ( detectedCs, detectedSymmetry );</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="comment">//================================================ Report progress</span></div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    std::stringstream hlpSS;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    hlpSS &lt;&lt; <span class="stringliteral">&quot;Detected group with fold &quot;</span> &lt;&lt; detectedSymmetry[0] &lt;&lt; <span class="stringliteral">&quot; along axis &quot;</span> &lt;&lt; detectedSymmetry[1] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; detectedSymmetry[2] &lt;&lt; <span class="stringliteral">&quot; ; &quot;</span> &lt;&lt; detectedSymmetry[3] &lt;&lt; <span class="stringliteral">&quot; and with peak height &quot;</span> &lt;&lt; detectedSymmetry[5];</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a> ( verbose, 4, hlpSS.str(), messageShift );</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    </div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    return ;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abdf51386543312d582141f8f052ea269"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdf51386543312d582141f8f052ea269">&#9670;&nbsp;</a></span>getAllAngleDifferences()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getAllAngleDifferences </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>angDiffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt;&#160;</td>
          <td class="paramname"><em>sphereVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function takes all angles present in this peak group and finds the set of unique angle differeces. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">angDiffs</td><td>A pointer to a vector to which all angle differences will be saved into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereVals</td><td>A vector of spheres with mapped rotation function values. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01499">1499</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;{</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    std::vector&lt; proshade_double &gt; angs;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    </div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="comment">//================================================ Find all present angles</span></div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign shPos = 0; shPos &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePositions.size() ); shPos++ )</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a>     ( &amp;angs, sphereVals.at(this-&gt;spherePositions.at(shPos))-&gt;getRadius() );</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    <span class="comment">//================================================ Find all angle differences</span></div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign ang1It = 0; ang1It &lt; static_cast&lt;proshade_unsign&gt; ( angs.size() ); ang1It++ )</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    {</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign ang2It = 1; ang2It &lt; static_cast&lt;proshade_unsign&gt; ( angs.size() ); ang2It++ )</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;        {</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;            <span class="comment">//======================================== Use unique combinations only</span></div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;            <span class="keywordflow">if</span> ( ang1It &gt;= ang2It ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;            </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;            <span class="comment">//======================================== Add angle difference rounded to 5 decimal places</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a> ( angDiffs, std::floor ( std::abs ( angs.at(ang1It) - angs.at(ang2It) ) * 100000.0 ) / 100000.0 );</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;        }</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    }</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">//================================================ Sort and remove duplicates</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    std::sort                                         ( (*angDiffs).begin(), (*angDiffs).end() );</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  (*angDiffs).erase                                   ( std::unique ( (*angDiffs).begin(), (*angDiffs).end() ), (*angDiffs).end() );</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    </div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    return ;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    </div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae52976c645e0860dfebb0cf209ae2235"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae52976c645e0860dfebb0cf209ae2235">&#9670;&nbsp;</a></span>getAllPossibleFolds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getAllPossibleFolds </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>angDiffs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_unsign &gt; *&#160;</td>
          <td class="paramname"><em>foldsToTry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function angle differences and creates a list of folds that may be present in the group. </p>
<p>The function starts by taking each detected angle difference and checking how well it divides a circle (2 Pi). The remainder of this division is then check against a tolerance threshold, which takes into account how many peaks in the rotation function space is the distance off from the theoretical exact value.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">angDiffs</td><td>A pointer to a vector containing all the unique angle differences for this peak group. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">foldsToTry</td><td>A pointer to a vector to which the predicted fold to try to find are to be saved into. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01541">1541</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;{</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    proshade_double divRem, divBasis, symmErr, angTolerance, angToleranceNext;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    proshade_double peakErr                           = ( M_PI * 2.0 ) / ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( this-&gt;dimension ) );</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    </div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="comment">//================================================ For each angle difference in the group</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign diffIt = 0; diffIt &lt; static_cast&lt;proshade_unsign&gt; ( angDiffs-&gt;size() ); diffIt++ )</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    {</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;        <span class="comment">//============================================ Find the basis and remainder of the 2pi/dist equation</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;        divRem                                        = std::modf ( <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( ( 2.0 * M_PI ) / std::abs ( angDiffs-&gt;at(diffIt) ) ), &amp;divBasis );</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="comment">//============================================ If the remainder would be smaller for larger basis, so change the basis</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordflow">if</span> ( divRem &gt; 0.5 )</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            divRem                                   -= 1.0;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            divBasis                                 += 1.0;</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;        </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <span class="comment">//============================================ Remove fold 1, that is not really what we are after here ...</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( divBasis ), rhs1 ( 1.0 );</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;        <span class="comment">//============================================ Is there enough angles in the group for such a fold?</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordflow">if</span> ( <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;spherePositions.size() ) &lt; ( divBasis - 1.0 ) ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        </div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        <span class="comment">//============================================ Determine errors on peaks and on folds</span></div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        symmErr                                       = divRem * ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( divBasis ) );</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        angTolerance                                  = std::abs( symmErr / peakErr );</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;        angToleranceNext                              = ( ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( divBasis ) ) - ( ( 2.0 * M_PI ) / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( divBasis + 1 ) ) ) / peakErr;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160; </div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;        <span class="comment">//============================================ Is remainder small enough?</span></div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordflow">if</span> ( angTolerance &lt; std::max ( 3.0, ( 0.1 / peakErr ) ) )</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            <span class="comment">//======================================== Is the next symmetry close enough? If so, test previous and next folds as well.</span></div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;            <span class="keywordflow">if</span> ( angToleranceNext &lt; std::max ( 1.5, ( 0.1 / peakErr ) ) )</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;            {</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                <span class="comment">//==================================== The next fold would pass as well. Use one previous and one following fold as well to cover for errors</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( foldsToTry, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( divBasis - 1 ) );</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( foldsToTry, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( divBasis + 1 ) );</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;            }</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;            </div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;            <span class="comment">//======================================== This fold seems reasonable, save it</span></div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;            <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a> ( foldsToTry, <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( divBasis ) );</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    }</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    </div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    <span class="comment">//================================================ Sort and remove duplicates</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    std::sort                                         ( (*foldsToTry).begin(), (*foldsToTry).end(), std::greater &lt;proshade_unsign&gt;() );</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;    foldsToTry-&gt;erase                                 ( std::unique ( (*foldsToTry).begin(), (*foldsToTry).end() ), (*foldsToTry).end() );</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    return ;</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    </div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa258af3697740d56ca7aff7ce5a80470"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa258af3697740d56ca7aff7ce5a80470">&#9670;&nbsp;</a></span>getBestIndexForFold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getBestIndexForFold </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>bestPosVal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>bestLatInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>bestLonInd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_unsign &gt; *&#160;</td>
          <td class="paramname"><em>spheresFormingFold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt;&#160;</td>
          <td class="paramname"><em>sphereVals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function which does simple search through all peak groups indices and saves the index with the highest peak height sum over all spheres. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bestPosVal</td><td>Pointer to double where the highest sum of heights will be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bestLatInd</td><td>Pointer to double where the highest values lattitude index will be held. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">bestLonInd</td><td>Pointer to double where the highest values longitude index will be held. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spheresFormingFold</td><td>A vector pointer to a vector containing the indices of the spheres forming this fold. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereVals</td><td>A vector of spheres with mapped rotation function values. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01652">1652</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;{</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;    proshade_double curPosVal;</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;   *bestPosVal                                        = -1.0;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;latFromInds &gt; this-&gt;latToInds ) { this-&gt;latToInds += <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;dimension ); }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">if</span> ( this-&gt;lonFromInds &gt; this-&gt;lonToInds ) { this-&gt;lonToInds += <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;dimension ); }</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">//================================================ Compute the best average peak height axis for peak indices</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign latIt = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;latFromInds ); latIt &lt;= static_cast&lt; proshade_unsign &gt; ( this-&gt;latToInds ); latIt++ )</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    {</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;        <span class="comment">//============================================ Deal with boundaries</span></div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="keywordflow">if</span> ( latIt &gt;= this-&gt;dimension ) { latIt -= this-&gt;dimension; this-&gt;latToInds -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;dimension ); }</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign lonIt = <span class="keyword">static_cast&lt;</span> proshade_unsign <span class="keyword">&gt;</span> ( this-&gt;lonFromInds ); lonIt &lt;= static_cast&lt; proshade_unsign &gt; ( this-&gt;lonToInds ); lonIt++ )</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        {</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;            <span class="comment">//======================================== Deal with boundaries</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;            <span class="keywordflow">if</span> ( lonIt &gt;= this-&gt;dimension ) { lonIt -= this-&gt;dimension; this-&gt;lonToInds -= <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( this-&gt;dimension ); }</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;            </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;            <span class="comment">//======================================== Initialise variables</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;            curPosVal                                 = 1.0;</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;            </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;            <span class="comment">//======================================== Find this indices value</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;            <span class="keywordflow">for</span> ( proshade_unsign sphIt = 0; sphIt &lt; static_cast&lt;proshade_unsign&gt; ( spheresFormingFold-&gt;size() ); sphIt++ )</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;            {</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                curPosVal                            += sphereVals.at(spheresFormingFold-&gt;at(sphIt))-&gt;getSphereLatLonPosition ( latIt, lonIt );</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;            }</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;            </div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;            <span class="comment">//======================================== If best, save it</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;            <span class="keywordflow">if</span> ( curPosVal &gt; *bestPosVal )</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;               *bestPosVal                            = curPosVal;</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;               *bestLatInd                            = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( latIt );</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;               *bestLonInd                            = <span class="keyword">static_cast&lt;</span> proshade_double <span class="keyword">&gt;</span> ( lonIt );</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;            }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;        }</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    return ;</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    </div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5392b0e56d4778e71b8cc3210c9a4232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5392b0e56d4778e71b8cc3210c9a4232">&#9670;&nbsp;</a></span>getLatFromIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getLatFromIndices </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor function for the private variable latFromInds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">latFromInds</td><td>The lattitude index start for the group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01356">1356</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;{</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;latFromInds );</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab955f6dac0370b10534daf95aefb8ae3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab955f6dac0370b10534daf95aefb8ae3">&#9670;&nbsp;</a></span>getLatToIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getLatToIndices </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor function for the private variable latToInds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">latToInds</td><td>The lattitude index end for the group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01367">1367</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;{</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;latToInds );</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ada8d87a2e27b4912e21eadf3df7dd17a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada8d87a2e27b4912e21eadf3df7dd17a">&#9670;&nbsp;</a></span>getLonFromIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getLonFromIndices </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor function for the private variable lonFromInds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">lonFromInds</td><td>The longitude index start for the group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01378">1378</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;{</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;lonFromInds );</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;    </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6f1ae0d2ef19b80c52dee0936aec54be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6f1ae0d2ef19b80c52dee0936aec54be">&#9670;&nbsp;</a></span>getLonToIndices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">proshade_double ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getLonToIndices </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor function for the private variable lonToInds. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">lonToInds</td><td>The longitude index end for the group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01389">1389</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;{</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;lonToInds );</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b8f8adfd3449c187a6c4804463a68f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b8f8adfd3449c187a6c4804463a68f1">&#9670;&nbsp;</a></span>getSpherePositions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; proshade_unsign &gt; ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getSpherePositions </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Accessor function for the private variable spherePositions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">spherePositions</td><td>A vector of all angles (spheres) indices present in this group. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01400">1400</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;{</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">return</span>                                            ( this-&gt;spherePositions );</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38b79345282923aa96a7b3ad7694985d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38b79345282923aa96a7b3ad7694985d">&#9670;&nbsp;</a></span>getSpheresFormingFold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getSpheresFormingFold </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>foldToTry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_unsign &gt; *&#160;</td>
          <td class="paramname"><em>spheresFormingFold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere.html">ProSHADE_internal_spheres::ProSHADE_rotFun_sphere</a> * &gt;&#160;</td>
          <td class="paramname"><em>sphereVals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>sphereAngleTolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function simply finds the indices of the spheres which form the requested form. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">foldToTry</td><td>The value of the fold for which all the required spheres are to be sought. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spheresFormingFold</td><td>A pointer to vector to which the sphere indices of spheres forming this fold will be saved into. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereVals</td><td>A vector of spheres with mapped rotation function values. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sphereAngleTolerance</td><td>The tolerance for how different the sphere angle can be for the sphere to be still considered. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01604">1604</a> of file <a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;{</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    <span class="comment">//================================================ Initialise local variables</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    proshade_double soughtAngle, minSphereVal;</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    proshade_unsign minSpherePos                      = 0;</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <span class="comment">//================================================ Generate expected angles and check if close-by sphere exists</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">for</span> ( proshade_double fIt = 1.0; fIt &lt; static_cast&lt;proshade_double&gt; ( foldToTry ); fIt += 1.0 )</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    {</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        <span class="comment">//============================================ Set variables for the iteration</span></div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        minSphereVal                                  = 999.9;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        soughtAngle                                   = fIt * ( 2.0 * M_PI / <span class="keyword">static_cast&lt;</span>proshade_double<span class="keyword">&gt;</span> ( foldToTry ) );</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="comment">//============================================ Find the closest sphere passing conditions</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign angsIt = 0; angsIt &lt; static_cast&lt;proshade_unsign&gt; ( this-&gt;spherePositions.size() ); angsIt++ )</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;            <span class="keywordflow">if</span> ( std::abs ( sphereVals.at(this-&gt;spherePositions.at(angsIt))-&gt;getRepresentedAngle() - soughtAngle ) &lt; sphereAngleTolerance )</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;            {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;                <span class="keywordflow">if</span> ( minSphereVal &gt; 1.0 - std::cos ( std::abs ( sphereVals.at(this-&gt;spherePositions.at(angsIt))-&gt;getRepresentedAngle() - soughtAngle ) ) )</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;                {</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;                    minSphereVal                      = 1.0 - std::cos ( std::abs ( sphereVals.at(this-&gt;spherePositions.at(angsIt))-&gt;getRepresentedAngle() - soughtAngle ) );</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                    minSpherePos                      = angsIt;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                }</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;            }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;        }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;       </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        <span class="comment">//============================================ If no passing sphere, test next fold</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keyword">const</span> FloatingPoint&lt; proshade_double &gt; lhs1 ( minSphereVal ), rhs1 ( 999.9 );</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <span class="keywordflow">if</span> ( lhs1.AlmostEquals ( rhs1 ) ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        <span class="comment">//============================================ Save best position</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <a class="code" href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a>     ( spheresFormingFold, this-&gt;spherePositions.at(minSpherePos) );</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    }</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    </div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    return ;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    </div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__spheres_8hpp_source.html">ProSHADE_spheres.hpp</a></li>
<li>src/proshade/<a class="el" href="_pro_s_h_a_d_e__spheres_8cpp_source.html">ProSHADE_spheres.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_aa3103c7b5e2dc2cbf1778705c7693334"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#aa3103c7b5e2dc2cbf1778705c7693334">ProSHADE_internal_misc::addToDblPtrVector</a></div><div class="ttdeci">void addToDblPtrVector(std::vector&lt; proshade_double * &gt; *vecToAddTo, proshade_double *elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00143">ProSHADE_misc.cpp:143</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html_a8edbe0a36f9af831a2160455386863ba"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a8edbe0a36f9af831a2160455386863ba">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::angularDistanceWithBorders</a></div><div class="ttdeci">proshade_signed angularDistanceWithBorders(proshade_signed origLat, proshade_signed testedLat)</div><div class="ttdoc">This function takes two lattitude or longitude positions and finds the smallest distance between them...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01150">ProSHADE_spheres.cpp:1150</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html_a64c2bf68cb38e2908f8ec78e1bcf987c"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#a64c2bf68cb38e2908f8ec78e1bcf987c">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::computeCornerPositions</a></div><div class="ttdeci">void computeCornerPositions(void)</div><div class="ttdoc">This function computes the group corner vectors, saving results into internal variables.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01120">ProSHADE_spheres.cpp:1120</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a51486f6276c28c1b503f19c36007b9e2"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a51486f6276c28c1b503f19c36007b9e2">ProSHADE_internal_maths::optimiseAxisBiCubicInterpolation</a></div><div class="ttdeci">void optimiseAxisBiCubicInterpolation(proshade_double *bestLattitude, proshade_double *bestLongitude, proshade_double *bestSum, std::vector&lt; proshade_unsign &gt; *sphereList, std::vector&lt; ProSHADE_internal_spheres::ProSHADE_rotFun_sphere * &gt; *sphereMappedRotFun, proshade_double step=0.05)</div><div class="ttdoc">This function provides axis optimisation given starting lattitude and longitude indices.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02744">ProSHADE_maths.cpp:2744</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a68c3eafaeea1c1873c33525f337f9d0b"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a68c3eafaeea1c1873c33525f337f9d0b">ProSHADE_internal_misc::addToDoubleVector</a></div><div class="ttdeci">void addToDoubleVector(std::vector&lt; proshade_double &gt; *vecToAddTo, proshade_double elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00077">ProSHADE_misc.cpp:77</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a79e789452e327bb07a53c5358f4d3eb0"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a79e789452e327bb07a53c5358f4d3eb0">ProSHADE_internal_maths::vectorOrientationSimilaritySameDirection</a></div><div class="ttdeci">bool vectorOrientationSimilaritySameDirection(proshade_double a1, proshade_double a2, proshade_double a3, proshade_double b1, proshade_double b2, proshade_double b3, proshade_double tolerance=0.1)</div><div class="ttdoc">This function compares two vectors using cosine distance and decides if they are similar using tolera...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02714">ProSHADE_maths.cpp:2714</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_af556836aa9286c1571196de442a6b493"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#af556836aa9286c1571196de442a6b493">ProSHADE_internal_misc::checkMemoryAllocation</a></div><div class="ttdeci">void checkMemoryAllocation(chVar checkVar, std::string fileP, unsigned int lineP, std::string funcP, std::string infoP=&quot;This error may occurs when ProSHADE requests memory to be\n                    : allocated to it and this operation fails. This could\n                    : happen when not enough memory is available, either due to\n                    : other processes using a lot of memory, or when the machine\n                    : does not have sufficient memory available. Re-run to see\n                    : if this problem persists.&quot;)</div><div class="ttdoc">Checks if memory was allocated properly.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8hpp_source.html#l00073">ProSHADE_misc.hpp:73</a></div></div>
<div class="ttc" id="aclass_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group_html_aa258af3697740d56ca7aff7ce5a80470"><div class="ttname"><a href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html#aa258af3697740d56ca7aff7ce5a80470">ProSHADE_internal_spheres::ProSHADE_rotFun_spherePeakGroup::getBestIndexForFold</a></div><div class="ttdeci">void getBestIndexForFold(proshade_double *bestPosVal, proshade_double *bestLatInd, proshade_double *bestLonInd, std::vector&lt; proshade_unsign &gt; *spheresFormingFold, std::vector&lt; ProSHADE_internal_spheres::ProSHADE_rotFun_sphere * &gt; sphereVals)</div><div class="ttdoc">Function which does simple search through all peak groups indices and saves the index with the highes...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__spheres_8cpp_source.html#l01652">ProSHADE_spheres.cpp:1652</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__misc_html_a16336bdf0b391c953a549d3df115d691"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__misc.html#a16336bdf0b391c953a549d3df115d691">ProSHADE_internal_misc::addToUnsignVector</a></div><div class="ttdeci">void addToUnsignVector(std::vector&lt; proshade_unsign &gt; *vecToAddTo, proshade_unsign elementToAdd)</div><div class="ttdoc">Adds the element to the vector.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__misc_8cpp_source.html#l00099">ProSHADE_misc.cpp:99</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__messages_html_a4f98d32ed17424a1d8bf451a68370e20"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__messages.html#a4f98d32ed17424a1d8bf451a68370e20">ProSHADE_internal_messages::printProgressMessage</a></div><div class="ttdeci">void printProgressMessage(proshade_signed verbose, proshade_signed messageLevel, std::string message, proshade_signed messageShift=0)</div><div class="ttdoc">General stdout message printing.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__messages_8cpp_source.html#l00071">ProSHADE_messages.cpp:71</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespace_pro_s_h_a_d_e__internal__spheres.html">ProSHADE_internal_spheres</a></li><li class="navelem"><a class="el" href="class_pro_s_h_a_d_e__internal__spheres_1_1_pro_s_h_a_d_e__rot_fun__sphere_peak_group.html">ProSHADE_rotFun_spherePeakGroup</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
