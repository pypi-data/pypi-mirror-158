<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ProSHADE: src/proshade/ProSHADE_data.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ProSHADE
   &#160;<span id="projectnumber">0.7.6.6 (JUL 2022)</span>
   </div>
   <div id="projectbrief">Protein Shape Detection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_pro_s_h_a_d_e__data_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ProSHADE_data.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This is the source file containing internal data representation and manipulation structures and functions.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="_pro_s_h_a_d_e__data_8hpp_source.html">ProSHADE_data.hpp</a>&quot;</code><br />
<code>#include &lt;gemmi/to_pdb.hpp&gt;</code><br />
</div>
<p><a href="_pro_s_h_a_d_e__data_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespace_pro_s_h_a_d_e__internal__symmetry"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html">ProSHADE_internal_symmetry</a></td></tr>
<tr class="memdesc:namespace_pro_s_h_a_d_e__internal__symmetry"><td class="mdescLeft">&#160;</td><td class="mdescRight">This namespace contains the symmetry detection related code. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a262d9e21cd6b81b8bda35ec22eb363dd"><td class="memItemLeft" align="right" valign="top">proshade_signed&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">ProSHADE_internal_symmetry::addAxisUnlessSame</a> (proshade_unsign fold, proshade_double axX, proshade_double axY, proshade_double axZ, proshade_double axHeight, proshade_double averageFSC, std::vector&lt; proshade_double * &gt; *prosp, proshade_double axErr)</td></tr>
<tr class="memdesc:a262d9e21cd6b81b8bda35ec22eb363dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function simply creates a new axis from information in aruments and tests if no such axis already exists, saving it if need be.  <a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a262d9e21cd6b81b8bda35ec22eb363dd">More...</a><br /></td></tr>
<tr class="separator:a262d9e21cd6b81b8bda35ec22eb363dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c650c19a6954800bba6b3a8f5842e6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">ProSHADE_internal_symmetry::findPredictedAxesHeights</a> (std::vector&lt; proshade_double * &gt; *ret, <a class="el" href="class_pro_s_h_a_d_e__internal__data_1_1_pro_s_h_a_d_e__data.html">ProSHADE_internal_data::ProSHADE_data</a> *dataObj, <a class="el" href="class_pro_s_h_a_d_e__settings.html">ProSHADE_settings</a> *settings)</td></tr>
<tr class="memdesc:a33c650c19a6954800bba6b3a8f5842e6"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finds the rotation function value for all axes supplied in the ret parameter.  <a href="namespace_pro_s_h_a_d_e__internal__symmetry.html#a33c650c19a6954800bba6b3a8f5842e6">More...</a><br /></td></tr>
<tr class="separator:a33c650c19a6954800bba6b3a8f5842e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a188746757d4fe33cc7bca307aa367bc7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">axesToGroupTypeSanityCheck</a> (proshade_unsign requiredAxes, proshade_unsign obtainedAxes, std::string groupType)</td></tr>
<tr class="memdesc:a188746757d4fe33cc7bca307aa367bc7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks that the required and obtained numbers of axes are correct, printing error if they are not.  <a href="_pro_s_h_a_d_e__data_8cpp.html#a188746757d4fe33cc7bca307aa367bc7">More...</a><br /></td></tr>
<tr class="separator:a188746757d4fe33cc7bca307aa367bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae56351defa0ee4f5777b61e58150aba4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a> (std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, std::vector&lt; proshade_double &gt; *elem, proshade_double matrixTolerance)</td></tr>
<tr class="memdesc:ae56351defa0ee4f5777b61e58150aba4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if the element list already contains a given matrix.  <a href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">More...</a><br /></td></tr>
<tr class="separator:ae56351defa0ee4f5777b61e58150aba4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa430bcd7dc43633680907360656b7799"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">checkElementsFormGroup</a> (std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, proshade_double matrixTolerance)</td></tr>
<tr class="memdesc:aa430bcd7dc43633680907360656b7799"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function checks if all group element products produce another group element.  <a href="_pro_s_h_a_d_e__data_8cpp.html#aa430bcd7dc43633680907360656b7799">More...</a><br /></td></tr>
<tr class="separator:aa430bcd7dc43633680907360656b7799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2a2bd26e2e081130593c7783c54f293"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">sortProSHADESymmetryByFSC</a> (proshade_double *a, proshade_double *b)</td></tr>
<tr class="memdesc:ae2a2bd26e2e081130593c7783c54f293"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function allows using std::sort to sort vectors of ProSHADE symmetry format.  <a href="_pro_s_h_a_d_e__data_8cpp.html#ae2a2bd26e2e081130593c7783c54f293">More...</a><br /></td></tr>
<tr class="separator:ae2a2bd26e2e081130593c7783c54f293"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the source file containing internal data representation and manipulation structures and functions. </p>
<p>This source file contains the ProSHADE_data class definitions as well as the code for simple manipulations with the data (more complex manipulations are done in dedicated source files) and caller functions for the more complex manipulations. The class described here is how ProSHADE stores the structural data internally; however, the user should not need to access any of this code manually, as changes to this structure may have large consequences unforseen by the user.</p>
<p>Copyright by Michal Tykac and individual contributors. All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met: 1) Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2) Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. 3) Neither the name of Michal Tykac nor the names of this code's contributors may be used to endorse or promote products derived from this software without specific prior written permission.</p>
<p>This software is provided by the copyright holders and contributors "as is" and any express or implied warranties, including, but not limitted to, the implied warranties of merchantibility and fitness for a particular purpose are disclaimed. In no event shall the copyright owner or the contributors be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including, but not limitted to, procurement of substitute goods or services, loss of use, data or profits, or business interuption) however caused and on any theory of liability, whether in contract, strict liability or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.</p>
<dl class="section author"><dt>Author</dt><dd>Michal Tykac </dd>
<dd>
Garib N. Murshudov </dd></dl>
<dl class="section version"><dt>Version</dt><dd>0.7.6.6 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>JUL 2022 </dd></dl>

<p class="definition">Definition in file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a188746757d4fe33cc7bca307aa367bc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a188746757d4fe33cc7bca307aa367bc7">&#9670;&nbsp;</a></span>axesToGroupTypeSanityCheck()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void axesToGroupTypeSanityCheck </td>
          <td>(</td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>requiredAxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_unsign&#160;</td>
          <td class="paramname"><em>obtainedAxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>groupType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks that the required and obtained numbers of axes are correct, printing error if they are not. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">requiredAxes</td><td>Number of axes that are required by the symmetry type. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">obtainedAxes</td><td>Number of axes given. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">groupType</td><td>A string specifying for which symmetry type the group elements are to be computed. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02975">2975</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;{</div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;    <span class="comment">//================================================ Sanity check</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;    <span class="keywordflow">if</span> ( obtainedAxes != requiredAxes )</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;    {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;        std::stringstream hlpSS;</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        hlpSS &lt;&lt; <span class="stringliteral">&quot;The supplied number of axes for group element\n                    : detection ( &gt;&quot;</span> &lt;&lt; obtainedAxes &lt;&lt; <span class="stringliteral">&quot;&lt; ) does not match the group type ( &gt;&quot;</span> &lt;&lt; groupType &lt;&lt; <span class="stringliteral">&quot;&lt; ).&quot;</span>;</div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;        <span class="keywordflow">throw</span> <a class="code" href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a> ( <span class="stringliteral">&quot;Mismatch between supplied number of axes and\n                    : symmetry type.&quot;</span>, <span class="stringliteral">&quot;ES00059&quot;</span>, __FILE__, __LINE__, __func__, hlpSS.str() );</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;    }</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;    </div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;    return ;</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;    </div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae56351defa0ee4f5777b61e58150aba4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae56351defa0ee4f5777b61e58150aba4">&#9670;&nbsp;</a></span>checkElementAlreadyExists()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkElementAlreadyExists </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *&#160;</td>
          <td class="paramname"><em>elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; proshade_double &gt; *&#160;</td>
          <td class="paramname"><em>elem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>matrixTolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if the element list already contains a given matrix. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">elements</td><td>Vector containing all group elements. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">elem</td><td>A single element which should already be in the list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrixTolerance</td><td>The maximum allowed trace error on rotation matrices to be still considered the same. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">elementFound</td><td>A boolean value stating if the element was found int the elements list or not. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l02997">2997</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;{</div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;    <span class="keywordtype">bool</span> elementFound                                 = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    </div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;    <span class="comment">//================================================ For each existing element</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign elIt = 0; elIt &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); elIt++ )</div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    {</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;        <span class="keywordflow">if</span> ( <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a4348a7a36275c9cea20b5c27093c9b7e">ProSHADE_internal_maths::rotationMatrixSimilarity</a> ( &amp;elements-&gt;at(elIt), elem, matrixTolerance ) )</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;        {</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            elementFound                              = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        }</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;    }</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;    </div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;    <span class="keywordflow">return</span>                                            ( elementFound );</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;    </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa430bcd7dc43633680907360656b7799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa430bcd7dc43633680907360656b7799">&#9670;&nbsp;</a></span>checkElementsFormGroup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkElementsFormGroup </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *&#160;</td>
          <td class="paramname"><em>elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double&#160;</td>
          <td class="paramname"><em>matrixTolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function checks if all group element products produce another group element. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">elements</td><td>Vector containing all group elements. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">matrixTolerance</td><td>The maximum trace error for the matrices to be still considered the same. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">isGroup</td><td>A boolean value stating if all group element products for another group element. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l03023">3023</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;{</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    <span class="comment">//================================================ Initialise variables</span></div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;    <span class="keywordtype">bool</span> isGroup                                      = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    </div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;    <span class="comment">//================================================ Multiply all group element pairs</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordflow">for</span> ( proshade_unsign gr1 = 0; gr1 &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); gr1++ )</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;    {</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;        <span class="keywordflow">for</span> ( proshade_unsign gr2 = 1; gr2 &lt; static_cast&lt;proshade_unsign&gt; ( elements-&gt;size() ); gr2++ )</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;        {</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;            <span class="comment">//======================================== Use unique pairs only</span></div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;            <span class="keywordflow">if</span> ( gr1 &gt;= gr2 ) { <span class="keywordflow">continue</span>; }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;            </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;            <span class="comment">//======================================== Multiply the two rotation matrices</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;            std::vector&lt; proshade_double &gt; product    = <a class="code" href="namespace_pro_s_h_a_d_e__internal__maths.html#a18222a942e5fff8eecd15f1235c609e1">ProSHADE_internal_maths::multiplyGroupElementMatrices</a> ( &amp;elements-&gt;at(gr1), &amp;elements-&gt;at(gr2) );</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;        </div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;            <span class="comment">//======================================== Check the group already contains the produces as an element</span></div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;            <span class="keywordflow">if</span> ( !<a class="code" href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a> ( elements, &amp;product, matrixTolerance ) )</div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;            {</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;                isGroup                               = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            }</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;        }</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;        </div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;        <span class="comment">//============================================ Stop if problem was found</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;        <span class="keywordflow">if</span> ( !isGroup ) { <span class="keywordflow">break</span>; }</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;    }</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;    </div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;    <span class="keywordflow">return</span>                                            ( isGroup );</div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;    </div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2a2bd26e2e081130593c7783c54f293"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2a2bd26e2e081130593c7783c54f293">&#9670;&nbsp;</a></span>sortProSHADESymmetryByFSC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sortProSHADESymmetryByFSC </td>
          <td>(</td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">proshade_double *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function allows using std::sort to sort vectors of ProSHADE symmetry format. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Pointer to a ProSHADE symmetry formatted array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">b</td><td>Pointer to a ProSHADE symmetry formatted array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">X</td><td>Boolean whether a is larger than b. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html#l01936">1936</a> of file <a class="el" href="_pro_s_h_a_d_e__data_8cpp_source.html">ProSHADE_data.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;{</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;    <span class="comment">//================================================ Done</span></div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;    <span class="keywordflow">return</span> ( a[6] &gt; b[6] );</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160; </div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclass_pro_s_h_a_d_e__exception_html"><div class="ttname"><a href="class_pro_s_h_a_d_e__exception.html">ProSHADE_exception</a></div><div class="ttdoc">This class is the representation of ProSHADE exception.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__exceptions_8hpp_source.html#l00036">ProSHADE_exceptions.hpp:37</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a4348a7a36275c9cea20b5c27093c9b7e"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a4348a7a36275c9cea20b5c27093c9b7e">ProSHADE_internal_maths::rotationMatrixSimilarity</a></div><div class="ttdeci">bool rotationMatrixSimilarity(std::vector&lt; proshade_double &gt; *mat1, std::vector&lt; proshade_double &gt; *mat2, proshade_double tolerance=0.1)</div><div class="ttdoc">This function compares the distance between two rotation matrices and decides if they are similar usi...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02576">ProSHADE_maths.cpp:2576</a></div></div>
<div class="ttc" id="anamespace_pro_s_h_a_d_e__internal__maths_html_a18222a942e5fff8eecd15f1235c609e1"><div class="ttname"><a href="namespace_pro_s_h_a_d_e__internal__maths.html#a18222a942e5fff8eecd15f1235c609e1">ProSHADE_internal_maths::multiplyGroupElementMatrices</a></div><div class="ttdeci">std::vector&lt; proshade_double &gt; multiplyGroupElementMatrices(std::vector&lt; proshade_double &gt; *el1, std::vector&lt; proshade_double &gt; *el2)</div><div class="ttdoc">This function computes matrix multiplication using the ProSHADE group element matrix format as input ...</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__maths_8cpp_source.html#l02523">ProSHADE_maths.cpp:2523</a></div></div>
<div class="ttc" id="a_pro_s_h_a_d_e__data_8cpp_html_ae56351defa0ee4f5777b61e58150aba4"><div class="ttname"><a href="_pro_s_h_a_d_e__data_8cpp.html#ae56351defa0ee4f5777b61e58150aba4">checkElementAlreadyExists</a></div><div class="ttdeci">bool checkElementAlreadyExists(std::vector&lt; std::vector&lt; proshade_double &gt; &gt; *elements, std::vector&lt; proshade_double &gt; *elem, proshade_double matrixTolerance)</div><div class="ttdoc">This function checks if the element list already contains a given matrix.</div><div class="ttdef"><b>Definition:</b> <a href="_pro_s_h_a_d_e__data_8cpp_source.html#l02997">ProSHADE_data.cpp:2997</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_fa9be34cc2c3eb9c0decdfb277595ca7.html">proshade</a></li><li class="navelem"><a class="el" href="_pro_s_h_a_d_e__data_8cpp.html">ProSHADE_data.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
