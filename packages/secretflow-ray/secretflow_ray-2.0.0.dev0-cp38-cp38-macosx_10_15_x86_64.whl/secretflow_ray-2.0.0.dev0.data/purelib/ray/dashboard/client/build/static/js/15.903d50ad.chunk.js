(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[15],{283:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"b",(function(){return u})),t.d(a,"d",(function(){return s})),t.d(a,"c",(function(){return m}));var n=t(27),r=t.n(n),l=t(41),c=t(28),o=t.n(c),i=function(){var e=Object(l.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.a.get("resource/cluster");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(e){return o.a.get("resource/job/".concat(e))},s=function(e){return o.a.get("resource/node/".concat(e))},m=function(){return o.a.get("namespaces/resources")}},285:function(e,a,t){"use strict";var n=t(746),r=t(22),l=t(0),c=t.n(l);a.a=c.a.memo((function(e){var a=Object(r.a)(),t=e.resource,l=e.title;return c.a.createElement("div",{style:{textAlign:"center"}}," ",c.a.createElement(n.a,{label:{autoRotate:!1,type:"inner",content:function(e){var a=e.type,t=e.percent,n=e.value;return"".concat(a,"\n").concat(n,"\n").concat((100*t).toFixed(2),"%")},style:{fonrSize:12,fill:a.palette.text.primary,stroke:a.palette.background.paper,textAlign:"center",lineWidth:2},layout:{type:"fixedOverlap"}},color:[a.palette.primary.light,a.palette.secondary.main],width:100,height:120,style:{margin:"0 auto"},legend:!1,angleField:"value",colorField:"type",data:[{type:"avalable",value:t.available},{type:"used",value:t.total-t.available}],pieStyle:{stroke:a.palette.background.paper}}),c.a.createElement("h5",null,l))}),(function(e,a){return JSON.stringify(e.resource)===JSON.stringify(a.resource)}))},751:function(e,a,t){"use strict";t.r(a);var n=t(8),r=t(91),l=t(171),c=t(241),o=t(748),i=t(728),u=t(93),s=t(126),m=t(227),d=t(83),p=t.n(d),b=t(0),v=t.n(b),E=t(40),g=t(277),f=t(64),j=t(33),h=t(35),O=t(52),y=t(278),k=t(17),N=t(45),x=t(13),w=t(228),C=t(229),P=t(230),R=t(231),I=t(232),S=t(236),U=t(285),A=t(55),T=t(283),M=t(97),D=function(e){var a,t,r,l,c=e.nodeId,o=Object(b.useState)(),i=Object(n.a)(o,2),s=i[0],d=i[1],p=Object(M.b)(),g=p.page,f=p.startIndex,j=p.endIndex,h=p.setPage,O=p.pageSize,y=Object(M.c)(),k=y.setSortKey,N=y.sorterFunc;if(Object(b.useEffect)((function(){Object(T.d)(c).then((function(e){e.data.data.resources&&d(e.data.data.resources)}))}),[c]),!s||!Object.keys(s).length)return null;var D=Array.from(new Set(s.jobs.map((function(e){return Object.keys(e.jobResources.acquiredResources)})).flatMap((function(e){return e})))),F=Math.ceil(((null===(a=s.jobs)||void 0===a?void 0:a.length)||0)/O);return v.a.createElement("div",null,v.a.createElement("h4",null,"Resource Utilization"),v.a.createElement(u.a,{container:!0,justify:"space-around"},(null==s||null===(t=s.resources)||void 0===t?void 0:t.memory)&&v.a.createElement(u.a,{item:!0},v.a.createElement(U.a,{title:"Memory",resource:s.resources.memory})),(null==s||null===(r=s.resources)||void 0===r?void 0:r.CPU)&&v.a.createElement(u.a,{item:!0},v.a.createElement(U.a,{title:"CPU",resource:s.resources.CPU}))),v.a.createElement("h4",null,"Job Acquired Resource"),v.a.createElement(S.a,{page:g,onChange:function(e,a){return h(a)},count:F}),v.a.createElement(A.b,{label:"Sorter",options:[""].concat(Object(x.a)(D)),onChange:function(e){return k(e)}}),v.a.createElement(m.a,null,v.a.createElement(w.a,null,v.a.createElement(C.a,null,v.a.createElement(P.a,null,v.a.createElement(R.a,null,"Job Id"),D.map((function(e){return v.a.createElement(R.a,{key:e},e)})))),v.a.createElement(I.a,null,null===(l=s.jobs)||void 0===l?void 0:l.sort(N).slice(f,j).map((function(e){return v.a.createElement(P.a,null,v.a.createElement(R.a,null,v.a.createElement(E.b,{to:"/job/".concat(e.jobId)},e.jobId)),D.map((function(a){var t;return v.a.createElement(R.a,{key:a},(null===(t=e.jobResources)||void 0===t?void 0:t.acquiredResources[a])||"-")})))}))))))},F=t(27),L=t.n(F),J=t(41),B=t(96),z=t(68),W=Object(r.a)((function(e){return{root:{padding:e.spacing(2)},paper:{padding:e.spacing(2),marginTop:e.spacing(2),marginBottom:e.spacing(2)},label:{fontWeight:"bold"},tab:{marginBottom:e.spacing(2)}}}));a.default=function(e){var a,t,r,d,x,w=W(),C=function(e){var a=e.match.params,t=Object(b.useState)("info"),r=Object(n.a)(t,2),l=r[0],c=r[1],o=Object(b.useState)(),i=Object(n.a)(o,2),u=i[0],s=i[1],m=Object(b.useState)("Loading the node infos..."),d=Object(n.a)(m,2),p=d[0],v=d[1],E=Object(b.useContext)(B.a).namespaceMap,g=Object(b.useState)(!0),f=Object(n.a)(g,2),j=f[0],h=f[1],O=Object(b.useRef)(),y=Object(b.useCallback)(Object(J.a)(L.a.mark((function e(){var t,n,r,l,c;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(j){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(z.a)(a.id);case 4:t=e.sent,n=t.data,r=n.data,l=n.msg,c=n.result,(null==r?void 0:r.detail)&&s(r.detail),l&&v(l),!1===c&&(v("Node Query Error Please Check Node Name"),h(!1)),O.current=setTimeout(y,4e3);case 11:case"end":return e.stop()}}),e)}))),[j,a.id]),k=null==u?void 0:u.raylet;return Object(b.useEffect)((function(){return y(),function(){O.current&&clearTimeout(O.current)}}),[y]),{params:a,selectedTab:l,nodeDetail:u,msg:p,isRefreshing:j,onRefreshChange:function(e){h(e.target.checked)},raylet:k,handleChange:function(e,a){c(a)},namespaceMap:E,nodeId:a.id}}(e),P=C.params,R=C.selectedTab,I=C.nodeDetail,S=C.msg,U=C.isRefreshing,A=C.onRefreshChange,T=C.raylet,M=C.handleChange,F=C.namespaceMap,Y=(null==I?void 0:I.cpuCount)||(null==I?void 0:I.cpus)||[];return v.a.createElement("div",{className:w.root},v.a.createElement(N.b,{title:"Node ".concat(null==T||null===(a=T.nodeId)||void 0===a?void 0:a.slice(0,5))}),v.a.createElement(f.a,{loading:S.startsWith("Loading")}),v.a.createElement(O.a,{title:v.a.createElement("div",null,"NODE - ",P.id," ",v.a.createElement(h.a,{type:"node",status:(null==I||null===(t=I.raylet)||void 0===t?void 0:t.state)||"LOADING"})," ",v.a.createElement(l.a,{title:"Auto Refresh",placement:"right"},v.a.createElement(c.a,{size:"small",checked:U,onChange:A,name:"refresh",inputProps:{"aria-label":"secondary checkbox"}})))},S),v.a.createElement(O.a,{title:"Detail"},v.a.createElement(o.a,{value:R,onChange:M,className:w.tab},v.a.createElement(i.a,{value:"info",label:"Info"}),v.a.createElement(i.a,{value:"resource",label:"Resource"}),v.a.createElement(i.a,{value:"worker",label:"Worker (".concat((null==I?void 0:I.workers.length)||0,")")}),v.a.createElement(i.a,{value:"actor",label:"Actor (".concat(Object.values((null==I?void 0:I.actors)||{}).length||0,")")})),I&&"info"===R&&v.a.createElement("div",{className:w.paper},v.a.createElement(u.a,{container:!0,spacing:2},Object(N.e)(I.slsUrl).map((function(e){return v.a.createElement(u.a,{item:!0},v.a.createElement(s.a,null,e))})),(null==I?void 0:I.logUrl)&&[v.a.createElement(u.a,{item:!0},v.a.createElement(s.a,null,v.a.createElement(E.b,{target:"_blank",to:"/log/".concat(encodeURIComponent(null==I?void 0:I.logUrl))},"Node Log"))),v.a.createElement(u.a,{item:!0},v.a.createElement(s.a,null,v.a.createElement(E.b,{target:"_blank",to:"/log/".concat(encodeURIComponent("".concat(null==I?void 0:I.logUrl,"/dashboard_agent.log")))},"Dashboard Agent")))]),v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Hostname")," ",I.hostname),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"IP")," ",I.ip)),v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"CPU (Logic/Physic)")," ",Y[0]," / ",Y[1]),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Load (1/5/15min)")," ",(null==I?void 0:I.loadAvg)&&I.loadAvg[0]&&I.loadAvg[0].map((function(e){return Number(e).toFixed(2)})).join("/"))),v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Load per CPU (1/5/15min)")," ",(null==I?void 0:I.loadAvg)&&I.loadAvg[1].map((function(e){return Number(e).toFixed(2)})).join("/")),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Boot Time")," ",p()(1e3*I.bootTime).format("YYYY/MM/DD HH:mm:ss"))),(null==I?void 0:I.net)&&v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Sent Tps")," ",Object(k.a)(null==I?void 0:I.net[0]),"/s"),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Recieved Tps")," ",Object(k.a)(null==I?void 0:I.net[1]),"/s")),v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Memory")," ",(null==I?void 0:I.mem)&&v.a.createElement(l.a,{title:v.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"}},"".concat(Object.entries(I.mem).map((function(e){var a=Object(n.a)(e,2),t=a[0],r=a[1];return"".concat(t,": ").concat(Object(k.a)(r))})).join("\n"))),arrow:!0,interactive:!0},v.a.createElement("div",null,v.a.createElement(j.a,{num:I.mem.used,total:I.mem.total},Object(k.a)(I.mem.used),"/",Object(k.a)(I.mem.total),"(",(I.mem.used/I.mem.total*100).toFixed(2),"%)")))),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"CPU")," ",v.a.createElement(l.a,{arrow:!0,interactive:!0,title:v.a.createElement("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word"}},"CPU Count(Logic/Physic): ".concat(null==I||null===(r=I.cpuCount)||void 0===r?void 0:r.join("/"),"\n\n---CPU Times---\n\n").concat(Object.entries((null==I?void 0:I.cpuTimesPercent)||{}).map((function(e){var a=Object(n.a)(e,2),t=a[0],r=a[1];return"".concat(t,": \t").concat(r,"%")})).join("\n")))},v.a.createElement("div",null,v.a.createElement(j.a,{num:Number((null==I?void 0:I.cpu)||(null==I?void 0:I.cpuPercent)),total:100},(null==I?void 0:I.cpu)||(null==I?void 0:I.cpuPercent),"%"))))),v.a.createElement(u.a,{container:!0,spacing:2},(null==I?void 0:I.disk)&&Object.entries(null==I?void 0:I.disk).map((function(e){var a=Object(n.a)(e,2),t=a[0],r=a[1];return v.a.createElement(u.a,{item:!0,xs:6,key:t},v.a.createElement("div",{className:w.label},"Disk (",t,")")," ",r&&v.a.createElement(j.a,{num:Number(r.used),total:r.total},Object(k.a)(r.used),"/",Object(k.a)(r.total),"(",r.percent,"%, ",Object(k.a)(r.free)," free)"))}))),v.a.createElement(u.a,{container:!0,spacing:2},v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Namespaces")," ",null===(d=F[I.hostname])||void 0===d?void 0:d.join(",")),v.a.createElement(u.a,{item:!0,xs:!0},v.a.createElement("div",{className:w.label},"Namespaces")," ",null===(x=F[I.hostname])||void 0===x?void 0:x.join(",")))),"resource"===R&&v.a.createElement(D,{nodeId:P.id}),(null==I?void 0:I.workers)&&"worker"===R&&v.a.createElement(v.a.Fragment,null,v.a.createElement(m.a,{className:w.paper},v.a.createElement(y.b,{workers:null==I?void 0:I.workers,actorMap:null==I?void 0:I.actors,entity:"node",entityId:I.raylet.nodeId}))),(null==I?void 0:I.actors)&&"actor"===R&&v.a.createElement(v.a.Fragment,null,v.a.createElement(m.a,{className:w.paper},v.a.createElement(g.a,{actors:I.actors,workers:null==I?void 0:I.workers})))))}}}]);