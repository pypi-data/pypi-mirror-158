import{ag as j,ah as m,e as k,ai as x,d as D,u as I,ac as f,b as r,f as P,h as s,o as y,g as v,w as h,l as R,aj as O,ak as U,al as V,am as $,i as S,af as F,an as H,ab as W,a2 as _,y as q}from"./index.81b118c5.js";import{u as z}from"./useRouteParam.14d7a074.js";const g=()=>{};function T(...[d,t,c={}]){const e=j(m(k(g)));return x(t,(n,i)=>{if(n===null&&i===void 0)return;if(n===null){e.isSubscribed()&&e.unsubscribe(),Object.assign(e,m(k(g)));return}const p=m(k(d,t,c));Object.assign(e,p)},{immediate:!0}),e}const J=D({__name:"BlocksCatalogCreate",setup(d){const t=I(),c=f({}),e=f(""),n=z("blockTypeName"),i=r(()=>n.value?[n.value]:null),p=T(F.getBlockTypeByName,i),o=r(()=>p.response),B=r(()=>o.value?[{blockSchemas:{blockTypeId:{any_:[o.value.id]}}}]:null),A=T(H.getBlockSchemas,B),l=r(()=>{var a;return(a=A.response)==null?void 0:a[0]});function w(){!l.value||!o.value||W.createBlockDocument({name:e.value,data:c.value,blockSchemaId:l.value.id,blockTypeId:o.value.id}).then(({id:a})=>{_("Block created successfully","success"),t.push(q.block(a))}).catch(a=>{_("Failed to create block","error"),console.error(a)})}function C(){t.back()}return(a,u)=>{const N=P("p-layout-default");return s(o)?(y(),v(N,{key:0,class:"blocks-catalog-create"},{header:h(()=>[R(s(O),{"block-type":s(o)},null,8,["block-type"])]),default:h(()=>[s(l)?(y(),v(s(U),V({key:0,data:c.value,"onUpdate:data":u[0]||(u[0]=b=>c.value=b),name:e.value,"onUpdate:name":u[1]||(u[1]=b=>e.value=b),"block-schema":s(l)},$({submit:w,cancel:C})),null,16,["data","name","block-schema"])):S("",!0)]),_:1})):S("",!0)}}});export{J as default};
