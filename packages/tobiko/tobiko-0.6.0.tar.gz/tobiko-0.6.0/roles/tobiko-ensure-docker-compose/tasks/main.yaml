---

- name: "Install latest Docker compose with Pip"
  become: true
  shell: |
    set -x
    python3 -m pip install docker-compose
  when: docker_compose_install_using_pip


- name: "Install latest Docker compose with Curl"
  become: true
  shell: |
    set -x
    VERSION=$(
      git ls-remote https://github.com/docker/compose |
      grep refs/tags |
      grep -oE "[0-9]+\.[0-9][0-9]+\.[0-9]+$" |
      sort --version-sort |
      tail -n 1)
    ARCH=$(uname -s)-$(uname -m)
    URL=https://github.com/docker/compose/releases/download/${VERSION}/docker-compose-${ARCH}
    mkdir -p $(dirname '{{ docker_compose_executable }}')
    curl -L ${URL} > '{{ docker_compose_executable }}'
    chmod +x '{{ docker_compose_executable }}'
  when: docker_compose_install_using_curl
