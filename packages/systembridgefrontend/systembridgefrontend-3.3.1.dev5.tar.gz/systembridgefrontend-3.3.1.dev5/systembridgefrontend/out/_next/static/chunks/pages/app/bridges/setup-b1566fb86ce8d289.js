(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[176],{8573:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/app/bridges/setup",function(){return r(3249)}])},311:function(e,t,r){"use strict";r.d(t,{Z:function(){return j}});var n=r(6042),a=r(9396),i=r(5893),o=r(7294),s=r(1163),c=r(9008),l=r.n(c),u=r(8298),d=r(2734),p=r(2293),h=r(3156),x=r(155),f=r(6886),g=r(3321),y=r(5861),m=r(7357);function v(e){var t=e.children,r=(0,u.Z)({disableHysteresis:!0,threshold:24});return(0,o.cloneElement)(t,{elevation:r?4:0})}var b=function(){var e=(0,o.useState)(!1),t=e[0],r=e[1],n=((0,o.useCallback)((function(){r(!t)}),[t]),(0,d.Z)());return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(v,{children:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(p.Z,{color:"transparent",elevation:0,children:(0,i.jsx)(h.Z,{maxWidth:"xl",sx:{padding:0},children:(0,i.jsx)(x.Z,{sx:{minHeight:50,maxHeight:50,padding:0,flex:1,alignItems:"center",justifyContent:"space-between",display:"flex",flexWrap:"nowrap"},children:(0,i.jsx)(f.ZP,{item:!0,children:(0,i.jsx)(g.Z,{href:"https://system-bridge.timmo.dev",target:"_blank",children:(0,i.jsx)(y.Z,{component:"div",variant:"h4",sx:{textTransform:"none",userSelect:"none",color:n.palette.primary.contrastText},children:"System Bridge"})})})})})}),(0,i.jsx)(m.Z,{sx:{height:n.spacing(18)}})]})})})},Z=!1;var j=function(e){var t=(0,s.useRouter)();return(0,o.useEffect)((function(){if(t.isReady&&!Z){var e,r,i,o;Z=!0;var s=(null===(e=t.query)||void 0===e?void 0:e.apiKey)||"",c=(null===(r=t.query)||void 0===r?void 0:r.apiPort)||"9170",l=!1;if((null===(i=t.query)||void 0===i?void 0:i.apiKey)||(l=!0,s=window.prompt("Please enter your API key",s)),(null===(o=t.query)||void 0===o?void 0:o.apiPort)||(l=!0,c=window.prompt("Please enter your API port (default: 9170)",c)),l&&s&&c){var u=t.asPath.split("?")[0];t.replace({pathname:u.includes(".html")?u:"".concat(u,".html"),query:(0,a.Z)((0,n.Z)({},t.query),{apiKey:s,apiPort:c})})}}}),[t]),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l(),{children:[(0,i.jsx)("title",{children:e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,i.jsx)("link",{rel:"canonical",href:e.url}),(0,i.jsx)("meta",{name:"description",content:e.description?"".concat(e.description):e.title?"".concat(e.title," - System Bridge"):"System Bridge"}),(0,i.jsx)("meta",{name:"keywords",content:e.keywords?"".concat(e.keywords):"system-bridge, system, bridge, typescript"})]}),!e.noHeader&&(0,i.jsx)(b,{}),e.children]})}},3249:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return W}});var n=r(5893),a=r(7294),i=r(311),o=r(7568),s=r(603),c=r(4051),l=r.n(c),u=r(1163),d=r(2734),p=r(3156),h=r(6886),x=r(8456),f=r(5861),g=r(8462),y=r(9294),m=r(9953),v=r(9669),b=r.n(v),Z=r(1946),j=r(4924),k=r(6042),w=r(9396),C=r(8396),P=r(657),S=r(7645),K=r(6514),E=r(9386),_=r(1425),B=r(3321);var F=function(e){var t=(0,a.useState)(e.bridgeEdit.bridge),r=t[0],i=t[1],s=(0,a.useState)({text:"",error:!1}),c=s[0],p=s[1],h=(0,u.useRouter)().query,x=function(e){return function(t){i((0,w.Z)((0,k.Z)({},r),(0,j.Z)({},e,t.target.value)))}};function g(){return(g=(0,o.Z)(l().mark((function t(){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b().delete("http://".concat((h.apiHost,window.location.hostname),":").concat(h.apiPort||9170,"/bridges/").concat(r.key),{headers:{"api-key":h.apiKey}});case 2:(n=t.sent)&&n.status<400?e.handleClose():p({text:"Failed to delete bridge",error:!0});case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function y(){return(y=(0,o.Z)(l().mark((function t(){var n,a,i,o;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m();case 2:if(!(n=t.sent)||!n.uuid){t.next=25;break}if(a=(0,w.Z)((0,k.Z)({},r),{key:n.uuid}),i="http://".concat((h.apiHost,window.location.hostname),":").concat(h.apiPort||9170,"/bridges"),console.log("Save:",{url:i,bridgeData:a}),t.prev=8,!e.bridgeEdit.edit){t.next=15;break}return t.next=12,b().put("".concat(i,"/").concat(r.key),a,{headers:{"api-key":h.apiKey}});case 12:t.t0=t.sent,t.next=18;break;case 15:return t.next=17,b().post(i,a,{headers:{"api-key":h.apiKey}});case 17:t.t0=t.sent;case 18:(o=t.t0)&&o.status<400?e.handleClose():p({text:"Failed to save bridge",error:!0}),t.next=25;break;case 22:t.prev=22,t.t1=t.catch(8),console.error(t.t1);case 25:case"end":return t.stop()}}),t,null,[[8,22]])})))).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=(0,o.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p({text:"Testing bridge..",error:!1}),!(null===r||void 0===r?void 0:r.apiKey)){e.next=17;break}return e.prev=2,e.next=5,b().get("http://".concat(r.host,":").concat(r.port,"/information"),{headers:{"api-key":r.apiKey}});case 5:if(!((t=e.sent)&&t.status<400)){e.next=10;break}return console.log("Information:",t.data),p({text:"Successfully connected to bridge.",error:!1}),e.abrupt("return",t.data);case 10:p({text:"Error testing bridge: ".concat(t.status," - ").concat(t.data),error:!0}),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(2),console.error("Error:",e.t0),p({text:"Error testing bridge: ".concat(e.t0.message),error:!0});case 17:return e.abrupt("return",null);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})))).apply(this,arguments)}var Z=(0,d.Z)(),F=(0,C.Z)(Z.breakpoints.down("lg"));return(0,n.jsxs)(P.Z,{"aria-labelledby":"form-dialog-title",fullScreen:F,maxWidth:"md",open:!0,children:[(0,n.jsxs)(S.Z,{id:"form-dialog-title",children:[e.bridgeEdit.edit?"Edit":""," ",r.name]}),(0,n.jsxs)(K.Z,{children:[(0,n.jsx)(E.Z,{autoFocus:!0,fullWidth:!0,id:"name",label:"Name",onChange:x("name"),type:"text",value:r.name||"",variant:"outlined",sx:{margin:Z.spacing(1,0)}}),(0,n.jsx)(E.Z,{fullWidth:!0,id:"host",label:"Host",onChange:x("host"),type:"text",value:r.host||"",variant:"outlined",sx:{margin:Z.spacing(1,0)}}),(0,n.jsx)(E.Z,{fullWidth:!0,id:"port",label:"Port",onChange:x("port"),type:"number",value:r.port||9170,variant:"outlined",sx:{margin:Z.spacing(1,0)}}),(0,n.jsx)(E.Z,{fullWidth:!0,id:"apiKey",label:"API Key",onChange:x("apiKey"),type:"text",value:r.apiKey||"",variant:"outlined",sx:{margin:Z.spacing(1,0)}})]}),(0,n.jsxs)(_.Z,{children:[(0,n.jsx)(B.Z,{onClick:function(){return g.apply(this,arguments)},color:"inherit",variant:"contained",sx:{margin:Z.spacing(1,0)},children:"Delete"}),(0,n.jsx)(f.Z,{color:c.error?"error":"textPrimary",variant:"subtitle2",sx:{margin:Z.spacing(0,1),flex:1,textAlign:"right"},children:c.text}),(0,n.jsx)(B.Z,{autoFocus:!0,onClick:function(){p({text:"",error:!1}),e.handleClose()},variant:"contained",children:"Cancel"}),(0,n.jsx)(B.Z,{onClick:function(){return y.apply(this,arguments)},color:"primary",variant:"contained",children:"Save"})]})]})},H={port:9170};var q=function(){var e=function(e,t){i({bridge:e,edit:t})},t=(0,a.useState)(),r=t[0],i=t[1],c=(0,a.useState)(),v=c[0],j=c[1],k=(0,s.Z)((0,Z.r)(),1)[0],w=(0,a.useState)(!1),C=w[0],P=w[1],S=(0,u.useRouter)().query,K=(0,a.useCallback)((0,o.Z)(l().mark((function e(){var t;return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Setup Bridges"),e.next=3,b().get("http://".concat((S.apiHost,window.location.hostname),":").concat(S.apiPort||9170,"/bridges"),{headers:{"api-key":S.apiKey}});case 3:(t=e.sent)&&t.status<400&&j(t.data);case 5:case"end":return e.stop()}}),e)}))),[S.apiHost,S.apiPort,S.apiKey]);function E(){return(E=(0,o.Z)(l().mark((function e(){return l().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return P(!0),e.next=3,K();case 3:i(void 0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(0,a.useEffect)((function(){!C&&S&&S.apiKey&&(P(!0),K())}),[C,K,S]);var _=(0,d.Z)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.Z,{maxWidth:"lg",children:k||v?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{component:"h2",variant:"h3",sx:{margin:_.spacing(2,1.5,6)},children:"Bridges"}),v?(0,n.jsx)(g.Z,{children:v.map((function(t){return(0,n.jsx)(y.ZP,{button:!0,onClick:function(){return e(t,!0)},children:(0,n.jsx)(m.Z,{primary:"".concat(t.name," ").concat(t.apiKey?"":"(Not Configured)"),secondary:"".concat(t.host,":").concat(t.port),color:t.apiKey?"primary":"error"})},t.key)}))}):"",(0,n.jsx)(y.ZP,{button:!0,onClick:function(){return e(H,!1)},children:(0,n.jsx)(m.Z,{primary:"Add Bridge",secondary:"Add a new bridge",color:"primary"})})]}):(0,n.jsx)(h.ZP,{container:!0,direction:"row",justifyContent:"center",sx:{margin:_.spacing(10,0,8)},children:(0,n.jsx)(x.Z,{})})}),r?(0,n.jsx)(F,{bridgeEdit:r,handleClose:function(){return E.apply(this,arguments)}}):""]})};var W=function(){return(0,n.jsx)(i.Z,{title:"Bridges",url:"https://system-bridge.timmo.dev",description:"Frontend for System Bridge",noHeader:!0,children:(0,n.jsx)(q,{})})}}},function(e){e.O(0,[51,356,316,699,669,767,774,888,179],(function(){return t=8573,e(e.s=t);var t}));var t=e.O();_N_E=t}]);