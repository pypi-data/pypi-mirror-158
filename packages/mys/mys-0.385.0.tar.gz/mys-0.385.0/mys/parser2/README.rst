Copied from CPython 08fb8ac99ab03d767aa0f1cfab3573eddf9df018 and
slightly modified.

https://github.com/python/cpython
