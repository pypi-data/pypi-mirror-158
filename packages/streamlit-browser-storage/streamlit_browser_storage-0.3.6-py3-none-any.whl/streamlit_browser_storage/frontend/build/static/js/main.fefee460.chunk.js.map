{"version":3,"sources":["CookieStorage.ts","LocalStorage.ts","SessionStorage.ts","BrowserStorage.tsx","index.tsx"],"names":["CookieStorage","cookies","this","Cookies","name","value","expires_at","extra","Date","set","path","sameSite","get","getAll","doNotParse","remove","LocalStorage","storage","localStorage","setItem","deleteExpired","getItem","all","Object","keys","forEach","removeItem","now","_","isNull","m","exec","length","expiresAt","parseInt","delete","SessionStorage","sessionStorage","prevResults","withStreamlitConnection","props","args","type","action","result","isEqual","Streamlit","setComponentValue","JSON","stringify","setComponentReady","useEffect","setFrameHeight","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"kQAIaA,EAAb,WAGI,aAAe,yBAFfC,aAEc,EACVC,KAAKD,QAAU,IAAIE,IAJ3B,uCAOI,SAAIC,EAAcC,EAAeC,GAE7B,IAAIC,EAAa,GAUjB,OATID,IACAC,EAAK,QAAc,IAAIC,KAAKF,IAGhCJ,KAAKD,QAAQQ,IAAIL,EAAMC,EAAvB,aACIK,KAAM,IACNC,SAAU,UACPJ,KAEA,IAnBf,iBAsBI,SAAIH,GACA,OAAOF,KAAKD,QAAQW,IAAIR,KAvBhC,oBA0BI,WACI,OAAOF,KAAKD,QAAQY,OAAO,CAAEC,YAAY,MA3BjD,oBA8BI,SAAOV,GAEH,OADAF,KAAKD,QAAQc,OAAOX,EAAM,CAAEM,KAAM,IAAKC,SAAU,YAC1C,MAhCf,K,QCDaK,EAAb,iDAEIC,QAAUC,aAFd,uCAII,SAAId,EAAcC,EAAeC,GAE7B,OADAJ,KAAKe,QAAQE,QAAQf,EAAMC,IACpB,IANf,iBASI,SAAID,GAEA,OADAF,KAAKkB,gBACElB,KAAKe,QAAQI,QAAQjB,IAAS,UAX7C,oBAcI,WAAU,IAAD,OACLF,KAAKkB,gBAEL,IAAIE,EAAW,GAMf,OALAC,OAAOC,KAAKtB,KAAKe,SAASQ,SAAQ,SAAArB,GAC9B,IAAIC,EAAQ,EAAKY,QAAQI,QAAQjB,GAEjCkB,EAAIlB,GAAQC,KAETiB,IAvBf,oBA0BI,SAAOlB,GAEH,OADAF,KAAKe,QAAQS,WAAWtB,IACjB,IA5Bf,2BA+BI,WAAiB,IAAD,OACRuB,EAAMnB,KAAKmB,MAEfJ,OAAOC,KAAKtB,KAAKe,SAASQ,SAAQ,SAAArB,GAC9B,IAAIC,EAAQ,EAAKY,QAAQI,QAAQjB,GAEjC,IAAKwB,IAAEC,OAAOxB,GAAQ,CAClB,IAAIyB,EAAI,YAAYC,KAAK1B,GAEzB,IAAKuB,IAAEC,OAAOC,IAAMA,EAAE,GAAGE,OAAS,EAAG,CACjC,IAAIC,EAAY,IAAOC,SAASJ,EAAE,IAE9BH,GAAOM,GACP,EAAKE,OAAO/B,YA5CpC,K,cCCagC,EAAb,4MAEInB,QAAUoB,eAFd,yBAAoCrB,GCQhCsB,EAAmB,GAuDRC,eAtDQ,SAACC,GAEpB,IAAQC,EAASD,EAATC,KAEFC,EAAOD,EAAI,KACXE,EAASF,EAAI,OACbrC,EAAOqC,EAAI,KACXpC,EAAQoC,EAAI,MACZR,EAAYQ,EAAI,WAElBxB,EAAe,IAAIjB,EACvB,OAAQ0C,GACJ,IAAK,eACDzB,EAAU,IAAID,EACd,MAEJ,IAAK,iBACDC,EAAU,IAAImB,EAItB,IAAIQ,EAAc,KAClB,OAAQD,GACJ,IAAK,MACDC,EAAS3B,EAAQR,IAAIL,EAAMC,EAAO4B,GAClC,MAEJ,IAAK,MACDW,EAAS3B,EAAQL,IAAIR,IAAS,QAC9B,MAEJ,IAAK,UACDwC,EAAS3B,EAAQJ,UAAY,GAC7B,MAEJ,IAAK,SACD+B,EAAS3B,EAAQkB,OAAO/B,GAehC,OARIwC,IAAWhB,IAAEiB,QAAQP,EAAYK,GAASC,KAC1CN,EAAYK,GAAUC,EAEtBE,IAAUC,kBAAkBC,KAAKC,UAAUL,IAC3CE,IAAUI,qBAGdC,qBAAU,kBAAML,IAAUM,eAAe,MAClC,iCC5DXC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,W","file":"static/js/main.fefee460.chunk.js","sourcesContent":["\nimport Cookies from \"universal-cookie\"\n\n\nexport class CookieStorage {\n    cookies: Cookies;\n\n    constructor() {\n        this.cookies = new Cookies();\n    }\n\n    set(name: string, value: string, expires_at: string) {\n\n        let extra: any = {};\n        if (expires_at) {\n            extra[\"expires\"] = new Date(expires_at);\n        }\n\n        this.cookies.set(name, value, {\n            path: \"/\",\n            sameSite: \"strict\",\n            ...extra,\n        });\n        return true;\n    }\n\n    get(name: string): string {\n        return this.cookies.get(name);\n    }\n\n    getAll() {\n        return this.cookies.getAll({ doNotParse: true });\n    }\n\n    delete(name: string) {\n        this.cookies.remove(name, { path: \"/\", sameSite: \"strict\" })\n        return true\n    }\n}\n","\nimport _ from \"underscore\";\n\nexport class LocalStorage {\n\n    storage = localStorage;\n\n    set(name: string, value: string, expires_at: string) {\n        this.storage.setItem(name, value);\n        return true;\n    }\n\n    get(name: string): string {\n        this.deleteExpired();\n        return this.storage.getItem(name) || \"null|\";\n    }\n\n    getAll() {\n        this.deleteExpired();\n\n        let all: any = {};\n        Object.keys(this.storage).forEach(name => {\n            let value = this.storage.getItem(name);\n\n            all[name] = value;\n        });\n        return all;\n    }\n\n    delete(name: string) {\n        this.storage.removeItem(name);\n        return true\n    }\n\n    deleteExpired() {\n        let now = Date.now();\n\n        Object.keys(this.storage).forEach(name => {\n            let value = this.storage.getItem(name);\n\n            if (!_.isNull(value)) {\n                let m = /\\|(\\d+|)$/.exec(value);\n\n                if (!_.isNull(m) && m[1].length > 0) {\n                    let expiresAt = 1000 * parseInt(m[1]);\n\n                    if (now >= expiresAt) {\n                        this.delete(name);\n                    }\n                }\n            }\n        });\n    }\n}\n","\nimport { LocalStorage } from \"./LocalStorage\";\n\n\nexport class SessionStorage extends LocalStorage {\n\n    storage = sessionStorage;\n\n}\n","\nimport {\n    Streamlit,\n    ComponentProps,\n    withStreamlitConnection,\n} from \"streamlit-component-lib\"\nimport React, { useEffect } from \"react\"\nimport { CookieStorage } from \"./CookieStorage\";\nimport { LocalStorage } from \"./LocalStorage\";\nimport { SessionStorage } from \"./SessionStorage\";\nimport _ from \"underscore\";\n\nlet prevResults: any = {};\nconst BrowserStorage = (props: ComponentProps) => {\n\n    const { args } = props\n\n    const type = args[\"type\"];\n    const action = args[\"action\"];\n    const name = args[\"name\"];\n    const value = args[\"value\"];\n    const expiresAt = args[\"expires_at\"];\n\n    let storage: any = new CookieStorage();\n    switch (type) {\n        case \"LocalStorage\":\n            storage = new LocalStorage();\n            break;\n\n        case \"SessionStorage\":\n            storage = new SessionStorage();\n            break;\n    }\n\n    let result: any = null;\n    switch (action) {\n        case \"SET\":\n            result = storage.set(name, value, expiresAt);\n            break;\n\n        case \"GET\":\n            result = storage.get(name) || \"null|\";\n            break;\n\n        case \"GET_ALL\":\n            result = storage.getAll() || {};\n            break;\n\n        case \"DELETE\":\n            result = storage.delete(name);\n            break;\n\n        default:\n            break;\n    }\n\n    if (result && !_.isEqual(prevResults[action], result)) {\n        prevResults[action] = result;\n\n        Streamlit.setComponentValue(JSON.stringify(result));\n        Streamlit.setComponentReady();\n    }\n\n    useEffect(() => Streamlit.setFrameHeight(0));\n    return <div></div>;\n}\n\nexport default withStreamlitConnection(BrowserStorage);\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport BrowserStorage from \"./BrowserStorage\"\n\nReactDOM.render(\n  <React.StrictMode>\n    <BrowserStorage />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n)\n"],"sourceRoot":""}