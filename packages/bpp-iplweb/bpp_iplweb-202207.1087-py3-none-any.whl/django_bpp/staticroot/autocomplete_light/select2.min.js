document.addEventListener("dal-init-function",function(){yl.registerFunction("select2",function($,t){var l=$(t);function r(t,e){if(e){var a=$("<span>");return a.html(t),a}return t}function e(t){var e=void 0!==l.attr("data-html")||void 0!==l.attr("data-result-html");if(t.create_id){var a=$("<span>").addClass("dal-create");return e?a.html(t.text):a.text(t.text)}return r(t.text,e)}var a=null;l.attr("data-autocomplete-light-url")&&(a={url:l.attr("data-autocomplete-light-url"),dataType:"json",delay:250,data:function(t){return{q:t.term,page:t.page,create:l.attr("data-autocomplete-light-create")&&!l.attr("data-tags"),forward:yl.getForwards(l)}},processResults:function(t,e){return l.attr("data-tags")&&$.each(t.results,function(t,e){e.id=e.text}),t},cache:!0}),l.select2({tokenSeparators:l.attr("data-tags")?[","]:null,debug:!0,containerCssClass:":all:",placeholder:l.attr("data-placeholder")||"",language:l.attr("data-autocomplete-light-language"),minimumInputLength:l.attr("data-minimum-input-length")||0,allowClear:!l.is("[required]"),templateResult:e,templateSelection:function(t){return void 0!==t.selected_text?r(t.selected_text,void 0!==l.attr("data-html")||void 0!==l.attr("data-selected-html")):e(t)},ajax:a,with:null,tags:Boolean(l.attr("data-tags"))}),l.on("select2:selecting",function(t){var r,e=t.params.args.data;!0===e.create_id&&(t.preventDefault(),r=l,$.ajax({url:l.attr("data-autocomplete-light-url"),type:"POST",dataType:"json",data:{text:e.id,forward:yl.getForwards(l)},beforeSend:function(t,e){t.setRequestHeader("X-CSRFToken",document.csrftoken)},success:function(t,e,a){r.append($("<option>",{value:t.id,text:t.text,selected:!0})),r.trigger("change"),r.select2("close")}}))})})});